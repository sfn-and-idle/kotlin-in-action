# 9μ¥. μ λ„¤λ¦­μ¤ 

## μ…κµ¬
- μ λ„¤λ¦­ ν•¨μμ™€ ν΄λμ¤λ¥Ό μ •μν•λ” λ°©λ²•
- νƒ€μ… μ†κ±°μ™€ μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°(reified type parameter)
- μ„ μ–Έ μ§€μ κ³Ό μ‚¬μ© μ§€μ  λ³€μ„±(declaration-site variance)

<span style="color:orange">μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°</span>λ¥Ό μ‚¬μ©ν•λ©΄ 
μΈλΌμΈ ν•¨μ νΈμ¶μ—μ„ νƒ€μ… μΈμλ΅ μ“°μΈ κµ¬μ²΄μ μΈ νƒ€μ…μ„ μ‹¤ν–‰ μ‹μ μ— μ• μ μλ‹¤.
(μΌλ° ν΄λμ¤λ‚ ν•¨μμ κ²½μ° νƒ€μ… μΈμ μ •λ³΄κ°€ μ‹¤ν–‰ μ‹μ μ— μ‚¬λΌμ§€κΈ° λ•λ¬Έμ— μ΄λ° μΌμ΄ λ¶κ°€λ¥ν•λ‹¤.)

<span style="color:orange">μ„ μ–Έ μ§€μ  λ³€μ„±</span>μ„ μ‚¬μ©ν•λ©΄ κΈ°μ € νƒ€μ…μ€ κ°™μ§€λ§ 
νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ λ‘ μ λ„¤λ¦­ νƒ€μ… Type< A >μ™€ Type< B >κ°€ μμ„ λ•
νƒ€μ… μΈμ Aμ™€ Bμ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„μ— λ”°λΌ 
λ‘ μ λ„¤λ¦­ νƒ€μ…μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ–΄λ–»κ² λλ”μ§€ μ§€μ •ν•  μ μλ‹¤.

- μλ¥Ό λ“¤μ–΄ List<Any>λ¥Ό μΈμλ΅ λ°›λ” ν•¨μκ°€ μλ‹¤κ³  ν–μ„ λ• 
  - List<Int>νƒ€μ…μ κ°’μ„ μ „λ‹¬ν•  μ μλ”μ§€ μ—¬λ¶€λ¥Ό μ„ μ–Έ μ§€μ  λ³€μ„±μ„ ν†µν•΄ μ§€μ •ν•  μ μλ‹¤

<span style="color:orange">μ‚¬μ© μ§€μ  λ³€μ„±</span>μ€ 
κ°™μ€ λ©ν‘(μ λ„¤λ¦­ νƒ€μ… κ°’ μ‚¬μ΄μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„ μ§€μ •)λ¥Ό 
μ λ„¤λ¦­ νƒ€μ… κ°’μ„ μ‚¬μ©ν•λ” μ„μΉμ—μ„ νλΌλ―Έν„° νƒ€μ…μ— λ€ν• μ μ•½μ„ ν‘μ‹ν•λ” λ°©μ‹μΌλ΅ λ‹¬μ„±ν•λ‹¤.



<br/>
<br/>


## 9.1. μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°

μ λ„¤λ¦­μ¤λ¥Ό μ‚¬μ©ν•λ©΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ°›λ” νƒ€μ…μ„ μ •μν•  μ μλ‹¤. 
μ λ„¤λ¦­ νƒ€μ…μ μΈμ¤ν„΄μ¤λ¥Ό λ§λ“¤λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ μΉν™ν•΄μ•Ό ν•λ‹¤.

- List νƒ€μ…μ΄ μλ‹¤κ³  ν–μ„ λ•, λ…ν™•ν•κ² λ¬Έμμ—΄μ„ λ‹΄λ” λ¦¬μ¤νΈ = List<String>
- Map νƒ€μ…μ€ μ λ„¤λ¦­ νƒ€μ…λ³€μλ΅ Map<K, V>ν•νƒλ΅ μ„ μ–Έμ΄ λμ–΄ μκ³ , 
  μ΄λ¥Ό μΈμ¤ν„΄μ¤ν™” ν• λ• Map<String, Person>μ²λΌ κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ¥Ό λ„κ²¨ μΈμ¤ν„΄μ¤ν™” ν• μ μλ‹¤.


μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” λ³΄ν†µ νƒ€μ…κ³Ό λ§μ°¬κ°€μ§€λ΅ νƒ€μ… μΈμλ„ μ¶”λ΅ ν•  μ μλ‹¤.

```kotlin
val authors = listOf("Dmitry", "Svetlana")
```

listOfμ— μ „λ‹¬λ λ‘ κ°’μ΄ λ¬Έμμ—΄μ΄κΈ° λ•λ¬Έμ— μ»΄νμΌλ¬λ” μ΄ λ¦¬μ¤νΈκ°€ List<String>μ΄λΌ μ¶”λ΅ ν•λ‹¤.
λ°λ©΄, λΉ λ¦¬μ¤νΈλ¥Ό λ§λ“¤ λ•λ” νƒ€μ… μΈμλ¥Ό μ¶”λ΅ ν•  κ·Όκ±°κ°€ μ—†μ–΄ μ§μ ‘ νƒ€μ…μ„ λ…μ‹ν•΄μ•Ό ν•λ‹¤.

```kotlin
// λ‘ μ„ μ–Έμ€ λ™λ“±
val readers: MutableList<String> = mutableListOf()
val readers = mutableListOf<String>()
```

> μλ°”μ™€ λ‹¬λ¦¬ μ½”ν‹€λ¦°μ—μ„λ” μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό ν”„λ΅κ·Έλλ¨Έκ°€ λ…μ‹ν•κ±°λ‚ μ»΄νμΌλ¬κ°€ μ¶”λ΅ ν•  μ μμ–΄μ•Ό ν•λ‹¤. 
> μλ°”λ” λ§¨ μ²μμ— μ λ„¤λ¦­ μ§€μ›μ΄ μ—†μ—κ³  μλ°” 1.5μ— λ’¤λ¦κ² μ λ„¤λ¦­μ„ λ„μ…ν–κΈ° λ•λ¬Έμ— 
> μ΄μ „ λ²„μ „κ³Ό νΈν™μ„±μ„ μ μ§€ν•κΈ° μ„ν•΄ νƒ€μ… μΈμκ°€ μ—†λ” μ λ„¤λ¦­ νƒ€μ…(raw νƒ€μ…)μ„ ν—μ©ν•λ‹¤.
> 
> μλ¥Ό λ“¤μ–΄ μλ°”μ—μ„λ” λ¦¬μ¤νΈ μ›μ† νƒ€μ…μ„ μ§€μ •ν•μ§€ μ•κ³  List νƒ€μ…μ λ³€μλ¥Ό μ„ μ–Έν•  μλ„ μλ‹¤. 
> μ½”ν‹€λ¦°μ€ μ²μλ¶€ν„° μ λ„¤λ¦­μ„ λ„μ…ν–κΈ° λ•λ¬Έμ— raw νƒ€μ…μ„ μ§€μ›ν•μ§€ μ•κ³  
> μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό (ν”„λ΅κ·Έλλ¨Έκ°€ μ§μ ‘ μ •μν•λ“  νƒ€μ… μ¶”λ΅ μ— μν•΄ μλ™μΌλ΅ μ •μλλ“ ) ν•­μƒ μ •μν•΄μ•Ό ν•λ‹¤.

<br/>


## 9.1.1. μ λ„¤λ¦­ ν•¨μμ™€ ν”„λ΅νΌν‹°

λ¦¬μ¤νΈλ¥Ό λ‹¤λ£¨λ” ν•¨μλ¥Ό μ‘μ„±ν•λ‹¤λ©΄ μ–΄λ–¤ νΉμ • νƒ€μ…μ„ μ €μ¥ν•λ” λ¦¬μ¤νΈλΏ μ•„λ‹λΌ 
λ¨λ“  λ¦¬μ¤νΈλ¥Ό λ‹¤λ£° μ μλ” ν•¨μλ¥Ό μ›ν•  κ²ƒμ΄λ‹¤. μ΄λ΄ λ• μ λ„¤λ¦­ ν•¨μλ¥Ό μ‘μ„±ν•΄μ•Ό ν•λ‹¤.
μ λ„¤λ¦­ ν•¨μλ¥Ό νΈμ¶ν•  λ• λ°λ“μ‹ κµ¬μ²΄μ  νƒ€μ…μΌλ΅ νƒ€μ… μΈμλ¥Ό λ„κ²¨μ•Ό ν•λ‹¤. 

μ»¬λ ‰μ…μ„ λ‹¤λ£¨λ” λΌμ΄λΈλ¬λ¦¬ ν•¨μλ” λ€λ¶€λ¶„ μ λ„¤λ¦­ ν•¨μλ‹¤.

```
     π‘‡ νƒ€μ… νλΌλ―Έν„° μ„ μ–Έ
    ----
fun <T> List<T>.slice(indices: IntRange): List<T>
            ----                              ----
            π‘†νƒ€μ… νλΌλ―Έν„°κ°€ μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ…μ— μ“°μΈλ‹¤π‘†
```

ν•¨μμ νƒ€μ… νλΌλ―Έν„° Tκ°€ μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ…μ— μ“°μΈλ‹¤. 
μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ… λ¨λ‘ List<T>λ‹¤. 
μ΄λ° ν•¨μλ¥Ό κµ¬μ²΄μ μΈ λ¦¬μ¤νΈμ— λ€ν•΄ νΈμ¶ν•  λ• νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •ν•  μ μλ‹¤. 
ν•μ§€λ§ μ‹¤μ λ΅λ” λ€λ¶€λ¶„ μ»΄νμΌλ¬κ°€ νƒ€μ… μΈμλ¥Ό μ¶”λ΅ ν•  μ μμΌλ―€λ΅ κ·Έλ΄ ν•„μ”κ°€ μ—†λ‹¤.

```kotlin
>>> val letters = ('a'..'z').toList()
>>> println(letters.slice<Char>(0..2)) // νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •
[a, b, c]
>>> println(letters.slice(10..13)) // μ»΄νμΌλ¬λ” μ—¬κΈ°μ„ Tκ°€ CharλΌλ” μ‚¬μ‹¤μ„ μ¶”λ΅ ν•λ‹¤
[k, l, m, n]
```

λ‘ νΈμ¶μ κ²°κ³Ό νƒ€μ…μ€ λ¨λ‘ List<Char>μ΄λ‹¤.
μ»΄νμΌλ¬λ” λ°ν™ νƒ€μ… List<T>μ Tλ¥Ό μμ‹ μ΄ μ¶”λ΅ ν• Charλ΅ μΉν™ν•λ‹¤.

filter ν•¨μμ μ •μμ—μ„ (T) -> Boolean νƒ€μ…μ ν•¨μλ¥Ό νλΌλ―Έν„°λ΅ λ°›λ”λ‹¤.
μ΄ ν•¨μλ¥Ό μ• μμ μ—μ„ λ³Έ λ³€μμ— μ μ©ν•λ” λ¶€λ¶„μ„ μ‚΄ν΄λ³΄μ.

```kotlin
val authors = listOf("Dmitry", "Svetlana")
val readers = mutableListOf<String>(/* ... */)
fun <T> List<T>.filter(predicate: (T) -> Boolean): List<T>
>>> readers.filter{ it !in authors }
```

λλ‹¤ νλΌλ―Έν„°μ— λ€ν•΄ μλ™μΌλ΅ λ§λ“¤μ–΄μ§„ λ³€μ itμ νƒ€μ…μ€ TλΌλ” μ λ„¤λ¦­ νƒ€μ…μ΄λ‹¤.
μ»΄νμΌλ¬λ” filterκ°€ List<T>νƒ€μ…μ λ¦¬μ¤νΈμ— λ€ν•΄ νΈμ¶λ  μ μλ‹¤λ” μ‚¬μ‹¤κ³Ό 
filterμ μμ‹  κ°μ²΄μΈ readerμ νƒ€μ…μ΄ List<String>μ΄λΌλ” κ²ƒμ„ μ•κ³ , 
μ΄λ¥Ό ν† λ€λ΅ Tκ°€ Stringμ΄λΌκ³  μ¶”λ΅ ν•λ‹¤.

ν΄λμ¤λ‚ μΈν„°νμ΄μ¤ μ•μ— μ •μλ λ©”μ†λ“, ν™•μ¥ ν•¨μ λλ” μµμƒμ„ ν•¨μμ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ„ μ–Έν•  μ μκ³ ,
ν™•μ¥ ν•¨μμ—μ„  μμ‹  κ°μ²΄λ‚ νλΌλ―Έν„° νƒ€μ…μ— λ”°λΌ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

μ λ„¤λ¦­ ν•¨μλ¥Ό μ •μν•  λ•μ™€ κ°™μ΄ μ λ„¤λ¦­ ν™•μ¥ ν”„λ΅νΌν‹°λ¥Ό μ„ μ–Έν•  μ μλ‹¤.

```kotlin
val <T> List<T>.penultimate: T // λ¨λ“  λ¦¬μ¤νΈ νƒ€μ…μ— μ΄ μ λ„¤λ¦­ ν™•μ¥ ν”„λ΅νΌν‹°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤
    get() = this[size - 2]
>>> println(listOf(1, 2, 3, 4).penultimate) // μ΄ νΈμ¶μ—μ„ νƒ€μ… νλΌλ―Έν„° Tλ” Intλ΅ μ¶”λ΅ λλ‹¤
3
```

> ### β…ν™•μ¥ ν”„λ΅νΌν‹°λ§ μ λ„¤λ¦­ν•κ² λ§λ“¤ μ μλ‹¤. 
> μΌλ°(ν™•μ¥μ΄ μ•„λ‹) ν”„λ΅νΌν‹°λ” νƒ€μ… νλΌλ―Έν„°λ¥Ό κ°€μ§ μ μ—†λ‹¤. 
> ν΄λμ¤ ν”„λ΅νΌν‹°μ— μ—¬λ¬ νƒ€μ…μ κ°’μ„ μ €μ¥ν•  μλ” μ—†μΌλ―€λ΅ 
> μ λ„¤λ¦­ν• μΌλ° ν”„λ΅νΌν‹°λ” λ§μ΄ λμ§€ μ•λ”λ‹¤. 
> μΌλ° ν”„λ΅νΌν‹°λ¥Ό μ λ„¤λ¦­ν•κ² μ •μν•λ©΄ μ»΄νμΌλ¬κ°€ λ‹¤μκ³Ό κ°™μ€ μ¤λ¥λ¥Ό ν‘μ‹ν•λ‹¤.
> 
> ```kotlin
> val <T> x: T = TODO() 
> Error: type parameter of a property must be used in its receiver type
> ```


<br/>


## 9.1.2. μ λ„¤λ¦­ ν΄λμ¤ μ„ μ–Έ

μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ½”ν‹€λ¦°μ—μ„λ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„£μ€ κΊ½μ‡  κΈ°νΈ (< >)λ¥Ό 
ν΄λμ¤(μΈν„°νμ΄μ¤) μ΄λ¦„ λ’¤μ— λ¶™μ΄λ©΄ ν΄λμ¤(μΈν„°νμ΄μ¤)λ¥Ό μ λ„¤λ¦­ν•κ² λ§λ“¤ μ μλ‹¤. 
νƒ€μ… νλΌλ―Έν„°λ¥Ό μ΄λ¦„ λ’¤μ— λ¶™μ΄κ³  λ‚λ©΄ 
ν΄λμ¤ λ³Έλ¬Έ μ•μ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ‹¤λ¥Έ μΌλ°νƒ€μ…μ²λΌ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
interface List<T> { // List μΈν„°νμ΄μ¤μ— TλΌλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό μ •μν•λ‹¤.
    operator fun get(index: Int): T // μΈν„°νμ΄μ¤ μ•μ—μ„ Tλ¥Ό μΌλ° νƒ€μ…μ²λΌ μ‚¬μ©ν•  μ μλ‹¤.
}
```

μ λ„¤λ¦­ ν΄λμ¤λ¥Ό ν™•μ¥ν•λ” ν΄λμ¤ λλ” μ λ„¤λ¦­ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤λ¥Ό μ •μν•λ ¤λ©΄ 
κΈ°λ° νƒ€μ…μ μ λ„¤λ¦­ νλΌλ―Έν„°μ— λ€ν•΄ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄μ•Ό ν•λ‹¤.
μ΄λ• κµ¬μ²΄μ μΈ νƒ€μ…μ„ λ„κΈΈ μλ„ μκ³  
(ν•μ„ ν΄λμ¤λ„ μ λ„¤λ¦­ ν΄λμ¤λΌλ©΄) νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ λ„κΈΈ μλ„ μλ‹¤.

```kotlin
// μ΄ ν΄λμ¤λ” κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ Stringμ„ μ§€μ •ν•΄ Listλ¥Ό κµ¬ν„ν•λ‹¤
class StringList: List<String> {
    override fun get(index: Int): String = ... // Stringμ„ μ–΄λ–»κ² μ‚¬μ©ν•λ”μ§€ μ‚΄ν΄λ³΄λΌ
}

// ArrayListμ μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„° Tλ¥Ό Listμ νƒ€μ… μΈμλ΅ λ„κΈ΄λ‹¤
class ArrayList<T>: List<T> {
    override fun get(index: Int): T = ...
}
```

StringList ν΄λμ¤λ” String νƒ€μ…μ μ›μ†λ§μ„ ν¬ν•¨. λ”°λΌμ„ Stringμ„ κΈ°λ° νƒ€μ…μ νƒ€μ… μΈμλ΅ μ§€μ •.
ν•μ„ ν΄λμ¤μ—μ„ μƒμ„ ν΄λμ¤μ— μ •μλ ν•¨μλ¥Ό μ¤λ²„λΌμ΄λ“ν•κ±°λ‚ μ‚¬μ©ν•λ ¤λ©΄ 
νƒ€μ… μΈμ Tλ¥Ό κµ¬μ²΄μ  νƒ€μ… StringμΌλ΅ μΉν™ν•΄μ•Ό ν•λ‹¤.
λ”°λΌμ„ StringListμ—μ„ `fun get(Int): T`κ°€ μ•„λ‹λΌ 
`fun get(Int): String`μ΄λΌλ” μ‹κ·Έλ‹μ²λ¥Ό μ‚¬μ©ν•λ‹¤.

ArrayList ν΄λμ¤λ” μμ‹ λ§μ νƒ€μ… νλΌλ―Έν„° Tλ¥Ό μ •μν•λ©΄μ„ κ·Έ Tλ¥Ό κΈ°λ° ν΄λμ¤μ νƒ€μ… μΈμλ΅ μ‚¬μ©ν•λ‹¤.
ArrayList<T>μ Tμ™€ μ•μ—μ„ λ³Έ List<T>μ Tλ” κ°™μ§€ μ•κ³ , μ „ν€ λ‹¤λ¥Έ νƒ€μ… νλΌλ―Έν„°μ΄λ‹¤.
μ‹¤μ λ΅λ” Tκ°€ μ•„λ‹ λ‹¤λ¥Έ μ΄λ¦„μ„ μ‚¬μ©ν•΄λ„ μλ―Έμ—λ” μ•„λ¬΄ μ°¨μ΄κ°€ μ—†λ‹¤.

ν΄λμ¤λ” μκΈ° μμ‹ μ„ νƒ€μ… μΈμλ΅ μ°Έμ΅°ν•  μ μλ‹¤.
Comparable μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤κ°€ μμ΄λ‹¤.

```kotlin
interface Comparable<T> {
    fun compareTo(other: T): Int
}

class String: Comparable<String> {
    override fun compareTo(other: String): Int = /* ... */
}
```

String ν΄λμ¤λ” μ λ„¤λ¦­ Comparable μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ©΄μ„ 
κ·Έ μΈν„°νμ΄μ¤μ νƒ€μ… νλΌλ―Έν„° Tλ΅ String μμ‹ μ„ μ§€μ •ν•λ‹¤.


<br/>


## 9.1.3. νƒ€μ… νλΌλ―Έν„° μ μ•½

<span style="color:orange">νƒ€μ… νλΌλ―Έν„° μ μ•½</span>μ€ 
ν΄λμ¤λ‚ ν•¨μμ— μ‚¬μ©ν•  μ μλ” νƒ€μ… μΈμλ¥Ό μ ν•ν•λ” κΈ°λ¥μ΄λ‹¤.
μ–΄λ–¤ νƒ€μ…μ„ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°μ— λ€ν• μƒν•(upper bound)μΌλ΅ μ§€μ •ν•λ©΄ 
κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• μ‚¬μ©ν•λ” νƒ€μ… μΈμλ” λ°λ“μ‹ κ·Έ μƒν• νƒ€μ…μ΄κ±°λ‚ 
κ·Έ μƒν• νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.
μ μ•½μ„ κ°€ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ λ’¤μ— μ½λ΅ (:)μ„ ν‘μ‹ν•κ³  κ·Έ λ’¤μ— μƒν• νƒ€μ…μ„ μ μΌλ©΄ λλ‹¤.

```
     π‘‡ νƒ€μ… νλΌλ―Έν„°
     --
fun <T : Number> List<T>.sum() : T
        -------
          π‘† μƒν•
```

μ•„λλ” μ‹¤μ  νƒ€μ… μΈμ(Int)κ°€ Numberλ¥Ό ν™•μ¥ν•λ―€λ΅ ν•©λ²•μ μΈ μμ‹

```kotlin
>>> println(listOf(1, 2, 3).sum())
6
```

νƒ€μ… νλΌλ―Έν„° Tμ— λ€ν• μƒν•μ„ μ •ν•κ³ λ‚λ©΄ T νƒ€μ…μ κ°’μ„ κ·Έ μƒν• νƒ€μ…μ κ°’μΌλ΅ μ·¨κΈ‰ν•  μ μλ‹¤.

```kotlin
// Numberλ¥Ό νƒ€μ… νλΌλ―Έν„° μƒν•μΌλ΅ μ •ν•λ‹¤
fun <T: Number> oneHalf(value: T): Double {
    return value.toDouble() / 2.0   // Number ν΄λμ¤μ— μ •μλ λ©”μ†λ“λ¥Ό νΈμ¶ν•  μ μλ‹¤.
}
>>> println(oneHalf(3))
1.5
```

λ‘ νλΌλ―Έν„° μ‚¬μ΄μ—μ„ λ” ν° κ°’μ„ μ°Ύλ” μ λ„¤λ¦­ ν•¨μ. 
λΉ„κµν•  μ μμ–΄μ•Ό μµλ“κ°’μ„ μ°Ύμ„ μ μμΌλ―€λ΅ 
ν•¨μ μ‹κ·Έλ‹μ²μ—λ„ λ‘ μΈμλ¥Ό μ„λ΅ λΉ„κµν•  μμμ–΄μ•Ό ν•λ‹¤λ” μ‚¬μ‹¤μ„ μ§€μ •ν•΄μ•Ό ν•λ‹¤.

```kotlin
// μ΄ ν•¨μλ“¤μ μΈμλ“¤μ€ λΉ„κµ κ°€λ¥ν•΄μ•Ό ν•λ‹¤.
fun <T: Comparable<T>> max(first: T, second: T): T {
    return if (first > second) first else second
}
>>> println(max("kotlin", "java")) // λ¬Έμμ—΄μ€ μ•νλ²³μμΌλ΅ λΉ„κµλλ‹¤
kotlin
```

maxλ¥Ό λΉ„κµν•  μ μ—†λ” κ°’ μ‚¬μ΄μ— νΈμ¶ν•λ©΄ μ»΄νμΌ μ¤λ¥κ°€ λ‚λ‹¤.

```kotlin
>>> println(max("kotlin", 42))
Error: Type parameter bound for T is not satisfied
inferred type Any is not a subtype of Comparable<Any>
```

Tμ μƒν• νƒ€μ…μ€ Comparable<T>λ‹¤.
Stringμ΄ Comparable<String>μ„ ν™•μ¥ν•λ―€λ΅ Stringμ€ max ν•¨μμ— μ ν•©ν• νƒ€μ… μΈμλ‹¤.

`first > second`λΌλ” μ‹μ€ μ½”ν‹€λ¦° μ—°μ‚°μ κ΄€λ΅€μ— λ”°λΌ 
`first.compareTo(second) > 0`μ΄λΌκ³  μ»΄νμΌ λλ‹¤.
max ν•¨μμ—μ„ firstμ νƒ€μ… Tλ” Comparable<T>λ¥Ό ν™•μ¥ν•λ―€λ΅ 
firstλ¥Ό λ‹¤λ¥Έ T νƒ€μ… κ°’μΈ secondμ™€ λΉ„κµν•  μ μλ‹¤.

λ“λ¬Όμ§€λ§ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ λ‘ μ΄μƒμ μ μ•½μ„ κ°€ν•΄μ•Ό ν•λ” κ²½μ°λ„ μλ‹¤.

- CharSequenceμ λ§¨ λμ— λ§μΉ¨ν‘(.)κ°€ μλ”μ§€ κ²€μ‚¬ν•λ” μ λ„¤λ¦­ ν•¨μ
  - ν‘μ¤€ StringBuilderλ‚ java.nio.CharBuffer ν΄λμ¤ λ“±μ— λ€ν•΄ μ΄ ν•¨μλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.


```kotlin
fun <T> ensureTrailingPeriod(seq: T) 
    where T: CharSequence, T: Appendable { // νƒ€μ… νλΌλ―Έν„° μ μ•½ λ©λ΅
    if (!seq.endsWith('.')) { // CharSequence μΈν„°νμ΄μ¤μ ν™•μ¥ν•¨μλ¥Ό νΈμ¶
        seq.append('.') // Appendable μΈν„°νμ΄μ¤μ λ©”μ†λ“λ¥Ό νΈμ¶
    }
}

>>> val helloWorld = StringBuilder("Hello World")
>>> ensureTrailingPeriod(helloWorld)
>>> println(helloWorld)
Hello World.
```

μμ λ” νƒ€μ… μΈμκ°€ CharSequenceμ™€ Appendable μΈν„°νμ΄μ¤λ¥Ό λ°λ“μ‹ κµ¬ν„ν•΄μ•Ό ν•λ‹¤λ” μ‚¬μ‹¤μ„ ν‘ν„ν•λ‹¤.
μ΄λ” λ°μ΄ν„°μ— μ ‘κ·Όν•λ” μ—°μ‚°(endsWith)κ³Ό 
ν…μ΄ν„°λ¥Ό λ³€ν™ν•λ” μ—°μ‚°(append)μ„ T νƒ€μ…μ κ°’μ—κ² μν–‰ν•  μ μλ‹¤λ” λ»μ΄λ‹¤.


<br/>


## 9.1.4. νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ ν•μ •

μ λ„¤λ¦­ ν΄λμ¤λ‚ ν•¨μλ¥Ό μ •μν•κ³  κ·Έ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ•λ” 
λ„μ΄ λ  μ μλ” νƒ€μ…μ„ ν¬ν•¨ν•λ” μ–΄λ–¤ νƒ€μ…μΌλ΅ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄λ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μΉν™ν•  μ μλ‹¤.
μ•„λ¬΄λ° μƒν•μ„ μ •ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ” κ²°κ³Όμ μΌλ΅ Any?λ¥Ό μƒν•μΌλ΅ μ •ν• νλΌλ―Έν„°μ™€ κ°™λ‹¤.

```kotlin
class Processor<T> {
  fun process(value: T) {
    value?.hashCode() // "value"λ” λ„μ΄ λ  μ μλ‹¤. λ”°λΌμ„ μ•μ „ν• νΈμ¶μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤. 
  }
}
```

process ν•¨μμ—μ„ value νλΌλ―Έν„°μ νƒ€μ… Tμ—λ” λ¬Όμν‘(?)κ°€ λ¶™μ–΄μμ§€ μ•μ§€λ§ 
μ‹¤μ λ΅λ” Tμ— ν•΄λ‹Ήν•λ” νƒ€μ… μΈμλ΅ λ„μ΄ λ  μ μλ” νƒ€μ…μ„ λ„κΈΈ μλ„ μλ‹¤.

```kotlin
// λ„μ΄ λ  μ μλ” νƒ€μ…μΈ String?μ΄ Tλ¥Ό λ€μ‹ ν•λ‹¤.
val nullableStringProcessor = Processor<String?>()
// μ΄ μ½”λ“λ” μ μ»΄νμΌλλ©° nullμ΄ value μΈμλ΅ μ§€μ •λλ‹¤
nullalbeStringProcessor.process(null)
```
ν•­μƒ λ„μ΄ λ  μ μ—†λ” νƒ€μ…λ§ νƒ€μ… μΈμλ΅ λ°›κ² λ§λ“¤λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„°μ— μ μ•½μ„ κ°€ν•΄μ•Ό ν•λ‹¤.
λ„ κ°€λ¥μ„±μ„ μ μ™Έν• μ•„λ¬΄λ° μ μ•½λ„ ν•„μ” μ—†λ‹¤λ©΄ Any? λ€μ‹  Anyλ¥Ό μƒν•μΌλ΅ μ‚¬μ©ν•λ©΄ λλ‹¤.

```kotlin
// nullμ΄ λ  μ μ—†λ” νƒ€μ… μƒν•μ„ μ§€μ •
class Processor<T: Any> {
    fun process(value: T) {
         value.hashCode() // T νƒ€μ…μ valueλ” nullμ΄ λ  μ μ—†λ‹¤
    }
}
```

<T: Any>λΌλ” μ μ•½μ€ T νƒ€μ…μ΄ ν•­μƒ λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ΄ λκ² λ³΄μ¥ν•λ‹¤.
μ»΄νμΌλ¬λ” νƒ€μ… μΈμμΈ String?κ°€ Anyμ μμ† νƒ€μ…μ΄ μ•„λ‹λ―€λ΅ 
Processor<String?>κ°™μ€ μ½”λ“λ¥Ό κ±°λ¶€ν•λ‹¤.

```kotlin
>>> val nullableStringProcessor = Processor<String?>()
Error: Type argument is not within its bounds.: should be subtype of 'Any'
```

νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ μ μ•½ν•κΈ°λ§ ν•λ©΄ 
νƒ€μ… μΈμλ΅ λ„μ΄ λ  μ μλ” νƒ€μ…μ΄ λ“¤μ–΄μ¤λ” μΌμ„ λ§‰μ„ μ μλ‹¤.
λ”°λΌμ„ Anyλ¥Ό μ‚¬μ©ν•μ§€ μ•κ³  λ‹¤λ¥Έ λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ„ μ‚¬μ©ν•΄ μƒν•μ„ μ •ν•΄λ„ λλ‹¤.



```kotlin
class Processor<T: Any> {
    fun process(value: T) {
        value.hashCode()
    }
}
```


<br/>
<br/>



## 9.2. μ‹¤ν–‰ μ‹ μ λ„¤λ¦­μ¤ λ™μ‘: μ†κ±°λ νƒ€μ… νλΌλ―Έν„°μ™€ μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°

JVMμ μ λ„¤λ¦­μ¤λ” λ³΄ν†µ <span style="color:orange">νƒ€μ… μ†κ±°</span>λ¥Ό μ‚¬μ©ν•΄ κµ¬ν„λλ‹¤. 
μ΄λ” μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤μ— νƒ€μ… μΈμ μ •λ³΄κ°€ λ“¤μ–΄μμ§€ μ•λ‹¤λ” λ»μ΄λ‹¤. 
μ½”ν‹€λ¦°μ—μ„ νƒ€μ… μ†κ±°κ°€ μ‹¤μ©μ μΈ λ©΄μ—μ„ μ–΄λ–¤ μν–¥μ„ λΌμΉλ”μ§€, 
ν•¨μλ¥Ό inlineμΌλ΅ μ„ μ–Έν•¨μΌλ΅μ¨ μ΄λ° μ μ•½μ„ μ°νν•  μ μλ”μ§€ μ•μ•„λ³΄μ.

ν•¨μλ¥Ό inlineμΌλ΅ λ§λ“¤λ©΄ νƒ€μ… μΈμκ°€ μ§€μ›μ§€μ§€ μ•κ² ν•  μ μλ‹¤. 
μ΄λ¥Ό μ½”ν‹€λ¦°μ—μ„  <span style="color:orange">μ‹¤μ²΄ν™”</span>λΌκ³  ν•λ‹¤.

<br/>

## 9.2.1. μ‹¤ν–‰ μ‹μ μ μ λ„¤λ¦­: νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤νΈ

μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ½”ν‹€λ¦° μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄λ” λ°νƒ€μ„μ— μ§€μ›μ§„λ‹¤.
μ λ„¤λ¦­ ν΄λμ¤ μΈμ¤ν„΄μ¤κ°€ κ·Έ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•  λ• μ“°μΈ νƒ€μ… μΈμμ— λ€ν• μ •λ³΄λ¥Ό μ μ§€ν•μ§€ μ•λ”λ‹¤.

μλ¥Ό λ“¤μ–΄ List<String> κ°μ²΄λ¥Ό λ§λ“¤κ³  κ·Έ μ•μ— λ¬Έμμ—΄μ„ μ—¬λΏ λ„£λ”λΌλ„ μ‹¤ν–‰ μ‹μ μ—λ” 
κ·Έ κ°μ²΄λ¥Ό μ¤μ§ Listλ΅λ§ λ³Ό μ μκ³ , μ–΄λ–¤ νƒ€μ…μ μ›μ†λ¥Ό μ €μ¥ν•λ”μ§€ μ• μ μ—†λ‹¤.

```kotlin
val list1: List<String> = listOf("a", "b")
val list2: List<Int> = listOf(1, 2, 3)
```

![κ·Έλ¦Ό 9.3](/Users/barley.son/dev/WhatTheKotlinInAction/src/main/kotlin/ch9/img9-3.png)

μ„ λ‘ Listλ¥Ό μ»΄νμΌλ¬λ” μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μΌλ΅ μΈμ‹ν•μ§€λ§ μ‹¤ν–‰ μ‹μ μ—μ„  μ™„μ „ν κ°™μ€ νƒ€μ…μ κ°μ²΄μ΄λ‹¤.
ν•μ§€λ§ μ»΄νμΌλ¬κ°€ νƒ€μ… μΈμλ¥Ό μ•κ³  μ¬λ°”λ¥Έ νƒ€μ…μ κ°’λ§ κ° λ¦¬μ¤νΈμ— λ„£μ–΄μ£Όλ„λ΅ λ³΄μ¥ν•μ—¬ 
List<String>μ—λ” λ¬Έμμ—΄λ§, List<Int>μ—λ” μ •μλ§ λ“¤μ–΄μλ‹¤κ³  κ°€μ •ν•  μ μλ‹¤.

νƒ€μ… μ†κ±°λ΅ μΈν•΄ μƒκΈ°λ” ν•κ³„λ¥Ό λ³΄λ©΄, νƒ€μ… μΈμλ¥Ό λ”°λ΅ μ €μ¥ν•μ§€ μ•μ•„ μ‹¤ν–‰ μ‹μ μ— νƒ€μ… μΈμλ¥Ό κ²€μ‚¬ν•  μ μ—†λ‹¤.
μ–΄λ–¤ λ¦¬μ¤νΈκ°€ λ¬Έμμ—΄λ΅ μ΄λ¤„μ§„ λ¦¬μ¤νΈμΈμ§€ λ‹¤λ¥Έ κ°μ²΄λ΅ μ΄λ¤„μ§„ κ²ƒμΈμ§€ μ‹¤ν–‰ μ‹μ μ— κ²€μ‚¬ν•  μ μ—†λ‹¤.
is κ²€μ‚¬μ—μ„ νƒ€μ… μΈμλ΅ μ§€μ •ν• νƒ€μ…μ„ κ²€μ‚¬ν•  μ μ—†λ‹¤.

```kotlin
>>> if (value is List<String>) {...}
ERROR: Cannot check for instance of erased type
```

λ‹¤λ§ μ €μ¥ν•΄μ•Ό ν•λ” νƒ€μ… μ •λ³΄μ ν¬κΈ°κ°€ μ¤„μ–΄λ“¤μ–΄ μ „λ°μ μΈ λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ΄ μ¤„μ–΄λ“ λ‹¤λ” μ λ„¤λ¦­ νƒ€μ… μ†κ±°μ μ¥μ μ΄ μλ‹¤.

μ•μ—μ„ λ΄¤λ“―μ΄ νƒ€μ… μΈμλ¥Ό λ…μ‹ν•μ§€ μ•κ³  μ λ„¤λ¦­ νƒ€μ…μ„ μ‚¬μ©ν•  μ μ—†λ‹¤.
μ–΄λ–¤ κ°’μ΄ μ§‘ν•©μ΄λ‚ λ§µμ΄ μ•„λ‹λΌ λ¦¬μ¤νΈλΌλ” μ‚¬μ‹¤μ„ ν™•μΈν•λ ¤λ©΄ 
<span style="color:orange">μ¤νƒ€ ν”„λ΅μ μ…</span>μ„ μ‚¬μ©ν•λ©΄ λλ‹¤.

```kotlin
if(value is List<*>) { ... }
```

νƒ€μ… νλΌλ―Έν„°κ°€ 2κ° μ΄μƒμ΄λ©΄ λ¨λ“  νƒ€μ… νλΌλ―Έν„°μ— *λ¥Ό ν¬ν•¨ν•΄μ•Ό ν•λ‹¤.

asλ‚ as? μΊμ¤ν…μ—λ„ μ λ„¤λ¦­ νƒ€μ…μ„ μ‚¬μ©ν•  μ μλ‹¤.
ν•μ§€λ§ κΈ°μ € ν΄λμ¤λ” κ°™μ§€λ§ νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ νƒ€μ…μΌλ΅ μΊμ¤ν…ν•΄λ„ μ—¬μ „ν μΊμ¤ν…μ— μ„±κ³µν•λ―€λ΅ μ΅°μ‹¬ν•΄μ•Ό ν•λ‹¤.
μ‹¤ν–‰ μ‹μ μ—λ” μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό μ• μ μ—†μΌλ―€λ΅ μΊμ¤ν…μ€ ν•­μƒ μ„±κ³µν•λ‹¤.
μ΄λ° νƒ€μ… μΊμ¤ν…μ„ μ‚¬μ©ν•λ©΄ μ»΄νμΌλ¬κ°€ `unchecked cast`(κ²€μ‚¬ν•  μ μ—†λ” μΊμ¤ν…)μ΄λΌλ” κ²½κ³ λ¥Ό ν•΄μ£Όμ§€λ§ 
μ»΄νμΌμ€ μ§„ν–‰ν•λ―€λ΅ μ›ν•λ” μ λ„¤λ¦­ νƒ€μ…μΌλ΅ μΊμ¤ν…ν•΄ μ‚¬μ©ν•΄λ„ λλ‹¤.

```kotlin
fun printSum(c: collection<*>) {
    val inList = c as? List<Int> // μ—¬κΈ°μ„ Unchecked cast: List<*> to List<Int> κ²½κ³  λ°μƒ
      ?: throw IllegalArgumentException("List is expected")
    println(inList.sum())
}

>>> println(listOf(1, 2, 3)) // μμƒλ€λ΅ μ‘λ™ν•λ‹¤
6
```

μ •μ λ¦¬μ¤νΈλ‚, μ§‘ν•©μ— λ€ν•΄ ν•¨μλ¥Ό νΈμ¶ν•λ©΄ μ •μ λ¦¬μ¤νΈμ— λ€ν•΄μ„  ν•©κ³„λ¥Ό μ¶λ ¥ν•κ³ , 
μ§‘ν•©μ— λ€ν•΄μ„  IllegalArgumentExceptionμ„ λ°μƒν•μ§€λ§, 
μλ»λ νƒ€μ…μ μ›μ†κ°€ λ“¤μ–΄μλ” λ¦¬μ¤νΈλ¥Ό μ „λ‹¬ν•λ©΄ μ‹¤ν–‰ μ‹μ μ— ClassCastExceptionμ΄ λ°μƒν•λ‹¤.

```kotlin
// μ§‘ν•©μ€ λ¦¬μ¤νΈκ°€ μ•„λ‹λ―€λ΅ μμ™Έκ°€ λ°μƒ
>>> printSum(setOf(1, 2, 3))                  
IllegalArgumentException: List is expected

// as? μΊμ¤ν…μ€ μ„±κ³µν•μ§€λ§ λ‚μ¤‘μ— λ‹¤λ¥Έ μμ™Έκ°€ λ°μƒ
>>> printSum(listOf("a", "b", "c"))          
ClassCastException: String cannot be cast to Number
```

μ–΄λ–¤ κ°’μ΄ List<Int>μΈμ§€ κ²€μ‚¬ν•  μλ” μ—†μΌλ―€λ΅ IllegalArgumentExceptionμ΄ λ°μƒν•μ§€λ” μ•λ”λ‹¤.
sumμ€ Number νƒ€μ…μ κ°’μ„ λ¦¬μ¤νΈμ—μ„ κ°€μ Έμ™€ λ”ν•λ ¤κ³  μ‹λ„ν•μ§€λ§ 
Stringμ„ Numberλ΅ μ‚¬μ©ν•λ ¤ ν•κΈ°μ— ClassCastExceptionμ΄ λ°μƒν•λ‹¤.

μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” μ»΄νμΌ μ‹μ μ— νƒ€μ… μ •λ³΄κ°€ μ£Όμ–΄μ§„ κ²½μ°μ—λ”
is κ²€μ‚¬λ¥Ό μν–‰ν•κ² ν—μ©ν•  μ μμ„ μ •λ„λ΅ λ‘λ‘ν•λ‹¤.

```kotlin
fun printSum(c: Collection<Int>) {
    if (c is List<Int>) { // μ΄ κ²€μ‚¬λ”γ„΄ μ¬λ°”λ¥΄λ‹¤
        println(c.sum())
    }
}
>>> printSum(listOf(1, 2, 3))
6
```

μ»΄νμΌ μ‹μ μ— c μ»¬λ ‰μ…μ΄ Int κ°’μ„ μ €μ¥ν•λ‹¤λ” μ‚¬μ‹¤μ΄ μ•λ ¤μ Έ μμΌλ―€λ΅ cκ°€ List<Int>μΈμ§€ κ²€μ‚¬ν•  μ μλ‹¤.

μΌλ°μ μΌλ΅ μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” μ•μ „ν•μ§€ λ»ν• κ²€μ‚¬μ™€ μν–‰ν•  μ μλ” κ²€μ‚¬λ¥Ό μ•λ ¤μ£ΌκΈ° μ„ν•΄ μµλ€ν• λ…Έλ ¥ν•λ‹¤.
(μ•μ „ν•μ§€ λ»ν• is κ²€μ‚¬λ” κΈμ§€ν•κ³  μ„ν—ν• as μΊμ¤ν…μ€ κ²½κ³ λ¥΄λ¥΄ μ¶λ ¥)
μ»΄νμΌλ¬ κ²½κ³ μ μλ―Έμ™€ μ–΄λ–¤ μ—°μ‚°μ΄ μ•μ „ν• μ§€μ— λ€ν•΄ μ•μ•„μ•Ό ν•λ‹¤.

<br/>



## 9.2.2. μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν• ν•¨μ μ„ μ–Έ

μ½”ν‹€λ¦°μ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμ μ •λ³΄λ” μ‹¤ν–‰ μ‹μ μ— μ§€μ›μ§„λ‹¤. 
λ”°λΌμ„ μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤κ°€ μμ–΄λ„ κ·Έ μΈμ¤ν„΄μ¤λ¥Ό λ§λ“¤ λ• μ‚¬μ©ν• νƒ€μ… μΈμλ¥Ό μ•μ•„λ‚Ό μ μ—†λ‹¤. 
μ λ„¤λ¦­ ν•¨μμ νƒ€μ… μΈμλ„ μ λ„¤λ¦­ ν•¨μκ°€ νΈμ¶λλ„ κ·Έ ν•¨μμ λ³Έλ¬Έμ—μ„λ” νΈμ¶μ‹ μ“°μΈ νƒ€μ… μΈμλ¥Ό μ• μ μ—†λ‹¤.

```kotlin
>>> fun <T> isA(value: Any) = value is T
Error: Cannot check for instance of erased type: T
```

μ΄λ° μ μ•½μ„ ν”Όν•  μ μλ” κ²½μ°κ°€ ν•λ‚ μλ‹¤.
μΈλΌμΈ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ” μ‹¤μ²΄ν™”λλ―€λ΅ μ‹¤ν–‰ μ‹μ μ— μΈλΌμΈ ν•¨μμ νƒ€μ… μΈμλ¥Ό μ• μ μλ‹¤.
μ„μ isA ν•¨μλ¥Ό μΈλΌμΈ ν•¨μλ΅ λ§λ“¤κ³  νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ μ§€μ •ν•λ©΄ 
valueμ νƒ€μ…μ΄ Tμ μΈμ¤ν„΄μ¤μΈμ§€λ¥Ό μ‹¤ν–‰ μ‹μ μ—μ„ κ²€μ‚¬ν•  μ μλ‹¤.

```kotlin
inline fun <reified T> isA(value: Any) = value is T
>>> println(isA<String>("abc"))
>>> println(isA<String>(123))

true
false
```

μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό ν™μ©ν•λ” κ°€μ¥ κ°„λ‹¨ν• μμ  μ¤‘ ν•λ‚λ” 
ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬ ν•¨μμΈ `filterIsInstance`μ΄λ‹¤.
μ΄ ν•¨μλ” μΈμλ΅ λ°›μ€ μ»¬λ ‰μ…μ μ›μ† μ¤‘μ—μ„ νƒ€μ… μΈμλ΅ μ§€μ •ν• ν΄λμ¤μ μΈμ¤ν„΄μ¤λ§μ„ λ¨μ•„ λ§λ“  λ¦¬μ¤νΈλ¥Ό λ°ν™ν•λ‹¤.

```kotlin
>>> val items = listOf("one", 2, "three")
>>> println(items.filterIsInstance<String>())
[one, three]
```

filterIsInstanceμ νƒ€μ… μΈμλ΅ Stringμ„ μ§€μ •ν•΄ 
ν•¨μμ λ°ν™ νƒ€μ…μ„ List<String>μΌλ΅ μ¶”λ΅ ν•  μ μκ² ν•λ‹¤.
λ”°λΌμ„ νƒ€μ… μΈμλ¥Ό μ‹¤ν–‰ μ‹μ μ— μ• μ μκ³  filterIsInstanceλ” κ·Έ νƒ€μ… μΈμλ¥Ό μ‚¬μ©ν•΄ 
λ¦¬μ¤νΈμ μ›μ† μ¤‘μ— μΈμμ™€ νƒ€μ…μ΄ μΌμΉν•λ” μ›μ†λ§μ„ μ¶”λ ¤λ‚Ό μ μλ‹¤.

μ•„λλ” ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬ ν•¨μ filterIsInstanceλ¥Ό κ°„λ‹¨ν•κ² μ •λ¦¬ν• λ²„μ „.

```kotlin
// reified ν‚¤μ›λ“λ” μ΄ νƒ€μ… νλΌλ―Έν„°κ°€ μ‹¤ν–‰ μ‹μ μ— μ§€μ›μ§€μ§€ μ•μμ„ ν‘μ‹ν•λ‹¤
inline fun <reified T> Iterable.filterIsInstance(): List<T> {
    val destination = mutableListOf<T>() 
    for (element in this) {
        // κ° μ›μ†κ°€ νƒ€μ… μΈμλ΅ μ§€μ •ν• ν΄λμ¤μ μΈμ¤ν„΄μ¤μΈμ§€ κ²€μ‚¬ν•  μ μλ‹¤
        if(element is T) {
            destination.add(element)
        }
    }
    return destination
}
```

> ### β… μΈλΌμΈ ν•¨μμ—μ„λ§ μ‹¤μ²΄ν™”ν• νƒ€μ… μΈμλ¥Ό μ“Έ μ μλ” μ΄μ  
> μ»΄νμΌλ¬λ” μΈλΌμΈ ν•¨μμ λ³Έλ¬Έμ„ κµ¬ν„ν• λ°”μ΄νΈμ½”λ“λ¥Ό κ·Έ ν•¨μκ°€ νΈμ¶λλ” λ¨λ“  μ§€μ μ— μ‚½μ…ν•λ‹¤. 
> μ»΄νμΌλ¬λ” μ‹¤μ²΄ν™”ν• νƒ€μ… μΈμλ¥Ό μ‚¬μ©ν•΄ μΈλΌμΈ ν•¨μλ¥Ό νΈμ¶ν•λ” κ° λ¶€λ¶„μ μ •ν™•ν• νƒ€μ… μΈμλ¥Ό μ• μ μλ‹¤. 
> λ”°λΌμ„ μ»΄νμΌλ¬λ” νƒ€μ… μΈμλ΅ μ“°μΈ κµ¬μ²΄μ μΈ ν΄λμ¤λ¥Ό μ°Έμ΅°ν•λ” λ°”μ΄νΈμ½”λ“λ¥Ό μƒμ„±ν•΄ μ‚½μ…ν•  μ μλ‹¤.
> 
> ```kotlin
> for (element in this) {
>     if(element is String) { // νΉμ • ν΄λμ¤ μ°Έμ΅°
>         destination.add(element)
>     }
> }
> ```
> 
> νƒ€μ… νλΌλ―Έν„°κ°€ μ•„λ‹λΌ κµ¬μ²΄μ μΈ νƒ€μ…μ„ μ‚¬μ©ν•λ―€λ΅ λ§λ“¤μ–΄μ§„ λ°”μ΄νΈμ½”λ“λ” 
> μ‹¤ν–‰ μ‹μ μ— λ²μ–΄μ§€λ” νƒ€μ… μ†κ±° μν–¥μ„ λ°›μ§€ μ•λ”λ‹¤.
> 
> μλ°” μ½”λ“μ—μ„λ” reified νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” inline ν•¨μλ¥Ό νΈμ¶ν•  μ μ—†λ‹¤λ” μ μ„ κΈ°μ–µν•μ.
> μλ°”μ—μ„λ” μ½”ν‹€λ¦° inline ν•¨μλ¥Ό μΌλ° ν•¨μμ²λΌ νΈμ¶ν•λ‹¤. 
> κ·Έ κ²½μ° μΈλΌμΈ ν•¨μλ¥Ό νΈμ¶ν•΄λ„ μ‹¤μ λ΅ μΈλΌμ΄λ‹μ΄ λμ§€ μ•λ”λ‹¤.
> μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°κ°€ μλ” ν•¨μμ κ²½μ° νƒ€μ… μΈμλ¥Ό λ°”μ΄νΈμ½”λ“μ— λ„£κΈ° μ„ν•΄ 
> μΌλ° ν•¨μλ³΄λ‹¤ λ” λ§μ€ μ‘μ—…μ΄ ν•„μ”ν•κ³ , ν•­μƒ μΈλΌμ΄λ‹ λμ–΄μ•Όλ§ ν•λ‹¤. 
> λ”°λΌμ„ μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°κ°€ μλ” μΈλΌμ΄λ‹ ν•¨μλ¥Ό μΌλ° ν•¨μμ²λΌ μλ°”μ—μ„λ” νΈμ¶ν•  μ μ—†λ‹¤.

μΈλΌμΈ ν•¨μμ—λ” μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°κ°€ μ—¬λΏ μκ±°λ‚ 
μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°μ™€ μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°κ°€ ν•¨κ» μμ„ μλ„ μλ‹¤.
ν•¨μμ νλΌλ―Έν„° μ¤‘μ— ν•¨μ νƒ€μ…μΈ νλΌλ―Έν„°κ°€ μκ³  
κ·Έ νλΌλ―Έν„°μ— ν•΄λ‹Ήν•λ” μΈμλ¥Ό ν•¨κ» μΈλΌμ΄λ‹ν•¨μΌλ΅ μ–»λ” μ΄μµμ΄ λ” ν° κ²½μ° ν•¨μλ¥Ό μΈλΌμΈ ν•¨μλ΅ λ§λ“λ”λ°, 
μ΄λ” μ„±λ¥ ν–¥μƒμ΄ μ•„λ‹ μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•κΈ° μ„ν•¨μ΄λ‹¤.

μ„±λ¥μ„ μΆ‹κ² ν•λ ¤λ©΄ μΈλΌμΈ ν•¨μμ ν¬κΈ°λ¥΄ κ³„μ† κ΄€μ°°ν•΄μ•Ό ν•λ‹¤. 
ν•¨μκ°€ μ»¤μ§€λ©΄ μ‹¤μ²΄ ν™”ν• νƒ€μ…μ— μμ΅΄ν•μ§€ μ•λ” λ¶€λ¶„μ„ λ³„λ„μ μΌλ° ν•¨μλ΅ λ½‘μ•„λ‚΄λ” νΈμ΄ λ‚«λ‹¤.

<br/>



## 9.2.3. μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ΅ ν΄λμ¤ μ°Έμ΅° λ€μ‹ 

`java.lang.Class` νƒ€μ… μΈμλ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” APIμ— λ€ν• μ½”ν‹€λ¦° μ–΄λ‘ν„°λ¥Ό κµ¬μ¶•ν•λ” κ²½μ° 
μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μμ£Ό μ‚¬μ©ν•λ‹¤.
μλ¥Ό λ“¤μ–΄ JDKμ `ServiceLoader`κ°€ μλ‹¤. 
μ΄λ” μ–΄λ–¤ μ¶”μƒ ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό ν‘ν„ν•λ” `java.lang.Class`λ¥Ό λ°›μ•„ 
κ·Έ ν΄λμ¤λ‚ μΈμ¤ν„΄μ¤λ¥Ό κµ¬ν„ν• μΈμ¤ν„΄μ¤λ¥Ό λ°ν™ν•λ‹¤.

μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό ν™μ©ν•΄ μ΄λ° APIλ¥Ό μ‰½κ² νΈμ¶ν•  μ μκ² λ§λ“λ” λ°©λ²•μ„ λ³΄λ„λ΅ ν•μ.
ServiceLoaderλ¥Ό μ‚¬μ©ν•΄ μ„λΉ„μ¤λ¥Ό μ½μ–΄ λ“¤μ΄κΈ° μ„ν• νΈμ¶ λ°©μ‹μ„ λ³΄κ² λ‹¤.

```kotlin
val serviceImpl = ServiceLoader.load(Service::Class.java)
```

::class.javaλ” μ½”ν‹€λ¦° ν΄λμ¤μ— λ€μ‘ν•λ” java.lang.Class μ°Έμ΅°λ¥Ό μ–»λ” λ°©λ²•μ΄λ‹¤.
Service::class.javaλΌλ” μ½”λ“λ” Service.classλΌλ” μλ°” μ½”λ“μ™€ μ™„μ „ν κ°™λ‹¤.

μ΄ μμ λ¥Ό κµ¬μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•΄ λ‹¤μ‹ μ‘μ„±ν•΄λ³΄μ.

```kotlin
val serviceImpl = loadService<Service>()
```

ν›¨μ”¬ μ§§λ‹¤! 
μ½μ–΄ λ“¤μΌ μ„λΉ„μ¤ ν΄λμ¤λ¥Ό loadService ν•¨μμ νƒ€μ… μΈμλ΅ μ§€μ •ν•λ©΄ 
::class.javaλΌκ³  μ“°λ” κ²½μ°λ³΄λ‹¤ ν›¨μ”¬ μ½κ³  μ΄ν•΄ν•κΈ° μ‰½λ‹¤.

loadService ν•¨μλ¥Ό μ–΄λ–»κ² μ •μν•  μ μλ”μ§€ μ‚΄ν΄λ³΄μ.

```kotlin
inline fun <reified T> loadService() { // νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ ν‘μ‹ν•λ‹¤
    return ServiceLoader.load(T::class.java) // T::classλ΅ νƒ€μ…νλΌλ―Έν„°μ ν΄λμ¤ κ°€μ Έμ¨λ‹¤
}
```

μΌλ° ν΄λμ¤μ— μ‚¬μ©ν•  μ μλ” `::class.java` κµ¬λ¬Έμ„ μ΄ κ²½μ°μ—λ„ μ‚¬μ©ν•  μ μλ‹¤.
μ΄λ¥Ό ν†µν•΄ νƒ€μ… νλΌλ―Έν„°λ΅ μ§€μ •λ ν΄λμ¤μ— λ”°λ¥Έ `java.lang.Class`λ¥Ό μ–»μ„ μ μκ³ , 
μ–»μ€ ν΄λμ¤ μ°Έμ΅°λ¥Ό λ³΄ν†µ λ•μ™€ λ§μ°¬κ°€μ§€λ΅ μ‚¬μ©ν•  μ μλ‹¤.

> ### β… μ•λ“λ΅μ΄λ“μ startActivity ν•¨μ κ°„λ‹¨ν•κ² λ§λ“¤κΈ°
> μ•΅ν‹°λΉ„ν‹°μ ν΄λμ¤λ¥Ό `java.lang.Class`λ΅ μ „λ‹¬ν•λ” λ€μ‹  μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.
> ```kotlin
> inline fun <reified T : Activity> 
>       Context.startActivity() { // νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ ν‘μ‹ν•λ‹¤
>     val intent = Intent(this, T::class.java) // T::classλ΅ νƒ€μ… νλΌλ―Έν„°μ ν΄λμ¤λ¥Ό κ°€μ Έμ¨λ‹¤
>     startActivity(intent)
> }
>
> startActivity<DetailActivity>() // μ•΅ν‹°λΉ„ν‹°λ¥Ό ν‘μ‹ν•κΈ° μ„ν•΄ λ©”μ†λ“λ¥Ό νΈμ¶ν•λ‹¤ 
> ```

<br/>



## 9.2.4. μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°μ μ μ•½

μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ” μ μ©ν• λ„κµ¬μ΄μ§€λ§ λ‡ κ°€μ§€ μ μ•½μ΄ μλ‹¤.
μΌλ¶€λ” μ‹¤μ²΄ν™”μ κ°λ…μΌλ΅ μΈν•΄ μƒκΈ°λ” μ μ•½μ΄λ©°, 
λ‚λ¨Έμ§€λ” μ§€κΈ μ½”ν‹€λ¦°μ΄ μ‹¤μ²΄ν™”λ¥Ό κµ¬ν„ν•λ” λ°©μ‹μ— μν•΄ μƒκΈ°λ” μ μ•½μΌλ΅ ν›„μ— μ™„ν™”λ  κ°€λ¥μ„±μ΄ μλ‹¤.

λ” κµ¬μ²΄μ μΌλ΅ λ‹¤μκ³Ό κ°™μ€ κ²½μ°μ— μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

- νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν…(is, !is, as, as?)
- μ½”ν‹€λ¦° λ¦¬ν”λ ‰μ… API(::class)
- μ½”ν‹€λ¦° νƒ€μ…μ— λ€μ‘ν•λ” java.lang.Classλ¥Ό μ–»κΈ°(::Class.java)
- λ‹¤λ¥Έ ν•¨μλ¥Ό νΈμ¶ν•  λ• νƒ€μ… μΈμλ΅ μ‚¬μ©

λ‹¤μκ³Ό κ°™μ€ μΌμ€ ν•  μ μ—†λ‹¤.

- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ μΈμ¤ν„΄μ¤ μƒμ„±ν•κΈ°
- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ λ™λ° κ°μ²΄ λ©”μ†λ“ νΈμ¶ν•κΈ°
- μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ”κµ¬ν•λ” ν•¨μλ¥Ό νΈμ¶ν•λ©΄μ„ 
  μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ νƒ€μ… μΈμλ΅ λ„κΈ°κΈ°
- ν΄λμ¤, ν”„λ΅νΌν‹°, μΈλΌμΈ ν•¨μκ°€ μ•„λ‹ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ μ§€μ •ν•κΈ°

μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μΈλΌμΈ ν•¨μμ—λ§ μ‚¬μ©ν•  μ μμ–΄ 
μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” ν•¨μλ” μμ‹ μ—κ² μ „λ‹¬λλ” λ¨λ“  λλ‹¤μ™€ ν•¨κ» μΈλΌμ΄λ‹λλ‹¤.

λλ‹¤ λ‚΄λ¶€μ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°©μ‹μ— λ”°λΌ 
λλ‹¤λ¥Ό μΈλΌμ΄λ‹ν•  μ μ—†λ” κ²½μ°κ°€ μƒκΈ°κΈ°λ„ ν•κ³  μ„±λ¥ λ¬Έμ λ΅ λλ‹¤λ¥Ό μΈλΌμ΄λ‹ν•κ³  μ‹¶μ§€ μ•μ„ μλ„ μλ‹¤.
μ΄ κ²½μ° noinline λ³€κ²½μλ¥Ό ν•¨μ νƒ€μ… νλΌλ―Έν„°μ— λ¶™μ—¬ μΈλΌμ΄λ‹μ„ κΈμ§€ν•  μ μλ‹¤.


<br/>
<br/>



## 9.3. λ³€μ„±: μ λ„¤λ¦­κ³Ό ν•μ„ νƒ€μ…

<span style="color:orange">λ³€μ„±(variance)</span> κ°λ…μ€ List<String>μ™€ List<Any>μ™€ κ°™μ΄ κΈ°μ € νƒ€μ…μ΄ κ°™κ³  
νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ μ—¬λ¬ νƒ€μ…μ΄ μ„λ΅ μ–΄λ–¤ κ΄€κ³„κ°€ μλ”μ§€ μ„¤λ…ν•λ” κ°λ…μ΄λ‹¤. 
λ³€μ„±μ„ μ ν™μ©ν•λ©΄ μ‚¬μ©μ— λ¶νΈν•μ§€ μ•μΌλ©΄μ„ νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•λ” APIλ¥Ό λ§λ“¤ μ μλ‹¤.

<br/>

## 9.3.1. λ³€μ„±μ΄ μλ” μ΄μ : μΈμλ¥Ό ν•¨μμ— λ„κΈ°κΈ°

List νƒ€μ…μ νλΌλ―Έν„°λ¥Ό λ°›λ” ν•¨μμ— Listμ„ λ„κΈ°λ©΄ μ•μ „ν• κΉ?

String ν΄λμ¤λ” Anyλ¥Ό ν™•μ¥ν•λ―€λ΅ Any νƒ€μ… κ°’μ„ νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ— String κ°’μ„ λ„κ²¨λ„ μ λ€ μ•μ „ν•λ‹¤.
ν•μ§€λ§ Anyμ™€ Stringμ΄ List μΈν„°νμ΄μ¤μ νƒ€μ… μΈμλ΅ λ“¤μ–΄κ°€λ” κ²½μ°μ—λ” μ λ€ μ•μ „ν•λ‹¤κ³  λ§ν•  μ μ—†λ‹¤.

λ¦¬μ¤νΈμ λ‚΄μ©μ„ μ¶λ ¥ν•λ” ν•¨μλ¥Ό λ³΄μ.

```kotlin
fun printContents(list: List<Any>) {
    println(list.joinToString())
}

>>> printContents(listOf("abc", "bac"))
abc, bac
```

μ„ κ²½μ° λ¬Έμμ—΄ λ¦¬μ¤νΈλ„ μ λ™μ‘ν•λ‹¤. κ° μ›μ†λ¥Ό Anyλ΅ μ·¨κΈ‰ν•λ©°, λ¨λ“  λ¬Έμμ—΄μ€ Any νƒ€μ…μ΄κΈ° λ•λ¬Έμ΄λ‹¤.

```kotlin
fun addAnswer(list:MutableList<Any>) {
    list.add(42)
}

>>> val strings = mutableListOf("abc", "bac")
>>> addAnswer(strings) // μ΄ μ¤„μ΄ μ»΄νμΌ λλ©΄
>>> println(strings.maxBy { it.length}) // μ‹¤ν–‰μ‹μ μ— μμ™Έκ°€ λ°μƒν•  κ²ƒμ΄λ‹¤
ClassCastException: Integer cannot be cast to String
```

MutableList<String> νƒ€μ…μ strings λ³€μλ¥Ό μ„ μ–Έν•΄ ν•¨μμ— λ„κΈΈ λ•, 
μ»΄νμΌλ¬κ°€ μ΄ μ‹μ„ λ°›μ•„λ“¤μ΄λ©΄ μ •μλ¥Ό λ¬Έμμ—΄ λ¦¬μ¤νΈ λ’¤μ— μ¶”κ°€ν•  μ μλ‹¤.
λ”°λΌμ„ μ΄ ν•¨μ νΈμ¶μ€ μ»΄νμΌλ  μ μ—†λ‹¤.
MutableList<Any>κ°€ ν•„μ”ν• κ³³μ— MutableList<String>μ„ λ„κΈ°λ©΄ μ•λλ‹¤λ” μ‚¬μ‹¤μ„ λ³΄μ—¬μ¤€λ‹¤.


μ΄μ  List<Any> νƒ€μ…μ νλΌλ―Έν„°λ¥Ό λ°›λ” ν•¨μμ— List<String>μ„ λ„κΈ°λ©΄ μ•μ „ν• μ§€μ— λ€ν•΄ λ³΄μ.
μ–΄λ–¤ ν•¨μκ°€ λ¦¬μ¤νΈμ μ›μ†λ¥Ό μ¶”κ°€ν•κ±°λ‚ λ³€κ²½ν•λ©΄ νƒ€μ… λ¶μΌμΉκ°€ μƒκΈΈ μ μμ–΄ 
List<Any> λ€μ‹  List<String>μ„ λ„κΈΈ μ μ—†λ‹¤.
ν•μ§€λ§ μ›μ† μ¶”κ°€λ‚ λ³€κ²½μ΄ μ—†λ‹¤λ©΄ λ€μ‹  λ„κ²¨λ„ μ•μ „ν•λ‹¤.

- μ½”ν‹€λ¦°μ—μ„λ” λ¦¬μ¤νΈμ λ³€κ²½ κ°€λ¥μ„±μ— λ”°λΌ μ μ ν• μΈν„°νμ΄μ¤λ¥Ό μ„ νƒν•λ©΄ 
  - μ•μ „ν•μ§€ λ»ν• ν•¨μ νΈμ¶μ„ λ§‰μ„ μ μλ‹¤.
- ν•¨μκ°€ μ½κΈ° μ „μ© λ¦¬μ¤νΈλ¥Ό λ°›λ”λ‹¤λ©΄ 
  - λ” κµ¬μ²΄μ μΈ νƒ€μ…μ μ›μ†λ¥Ό κ°–λ” λ¦¬μ¤νΈλ¥Ό κ·Έ ν•¨μμ— λ„κΈΈ μ μμ§€λ§, 
- λ¦¬μ¤νΈκ°€ λ³€κ²½ κ°€λ¥ν•λ‹¤λ©΄ 
  - κ·Έλ΄ μ μ—†λ‹¤.


<br/>

## 9.3.2. ν΄λμ¤, νƒ€μ…, ν•μ„νƒ€μ…

μ λ„¤λ¦­ ν΄λμ¤κ°€ μ•„λ‹ ν΄λμ¤μ—μ„λ” ν΄λμ¤ μ΄λ¦„μ„ λ°”λ΅ νƒ€μ…μΌλ΅ μ“Έ μ μλ‹¤.

- μ) `var x: String`μ΄λΌκ³  μ“°λ©΄ 
  - String ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό μ €μ¥ν•λ” λ³€μλ¥Ό μ •μν•  μ μκ³ , 
  - `var x: String?`μ²λΌ κ°™μ€ ν΄λμ¤ μ΄λ¦„μ„ λ„μ΄ λ  μ μλ” νƒ€μ…μ—λ„ μ“Έ μ μλ‹¤.

μ λ„¤λ¦­ ν΄λμ¤μ—μ„λ” μƒν™©μ΄ λ” λ³µμ΅ν•λ‹¤.
μ¬λ°”λ¥Έ νƒ€μ…μ„ μ–»μΌλ ¤λ©΄ **μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ λ°”κΏ”μ¤μ•Ό** ν•λ‹¤.
Listλ” νƒ€μ…μ΄ μ•„λ‹λ‹¤. ν•μ§€λ§ ν΄λμ¤λ‹¤. 
ν•μ§€λ§ νƒ€μ… μΈμλ¥Ό μΉν™ν• List<Int>, List<String?>, List<List<String>> λ“±μ€ 
λ¨λ‘ μ λ€λ΅ λ νƒ€μ…μ΄λ‹¤.
κ°κ°μ μ λ„¤λ¦­ ν΄λμ¤λ” λ¬΄μν λ§μ€ νƒ€μ…μ„ λ§λ“¤ μ μλ‹¤.

νƒ€μ… μ‚¬μ΄μ κ΄€κ³„λ¥Ό λ…Όν•κΈ° μ„ν•΄μ„λ” 
<span style="color:orange">ν•μ„ νƒ€μ…</span>μ΄λΌλ” κ°λ…μ„ μ μ•μ•„μ•Ό ν•λ‹¤.
μ–΄λ–¤ νƒ€μ… Aμ κ°’μ΄ ν•„μ”ν• λ¨λ“  μ¥μ†μ— μ–΄λ–¤ νƒ€μ… Bμ κ°’μ„ λ„£μ–΄λ„ μ•„λ¬΄ λ¬Έμ κ°€ μ—†λ‹¤λ©΄ νƒ€μ… Bλ” Aμ ν•μ„ νƒ€μ…μ΄λ‹¤.

- ex) Intλ” Numberμ ν•μ„ νƒ€μ…μ΄μ§€λ§ Stringμ ν•μ„ νƒ€μ…μ€ μ•„λ‹λ‹¤.

<span style="color:orange">μƒμ„ νƒ€μ…</span>μ€ ν•μ„ νƒ€μ…μ λ°λ€λ΅ 
A νƒ€μ…μ΄ B νƒ€μ…μ ν•μ„ νƒ€μ…μ΄λΌλ©΄ Bλ” Aμ μƒμ„ νƒ€μ…μ΄λ‹¤.

```mermaid
graph BT
      x["μƒμ„ νƒ€μ…"] --"β…"--> y["ν•μ„ νƒ€μ…"]
      A["B"] --"β…"--> B["A"]
      C["Int"]--"β…"-->D["Number"]
      e["Int"] --"β…"--> f["Int"]
      g["Int"] --"β"--> h["String"]
```

- Aκ°€ ν•„μ”ν• λ¨λ“  κ³³μ— Bλ¥Ό μ‚¬μ©ν•  μ μμΌλ©΄ Bλ” Aμ ν•μ„ νƒ€μ…μ΄λ‹¤.

μ»΄νμΌλ¬λ” λ³€μ λ€μ…μ΄λ‚ ν•¨μ μΈμ μ „λ‹¬ μ‹ ν•μ„ νƒ€μ… κ²€μ‚¬λ¥Ό λ§¤λ² μν–‰ν•λ‹¤.

```kotlin
fun test(i: Int) {
    val n: Number = i  // Intλ” Numberμ ν•μ„ νƒ€μ…μ΄λ―€λ΅ μ»΄νμΌλλ‹¤.
    
    fun f(s: String) { /*. . .*/ }
    f(i) // Intκ°€ Stringμ ν•μ„ νƒ€μ…μ΄ μ•„λ‹λ―€λ΅ μ»΄νμΌλμ§€ μ•λ”λ‹¤.
}
```

μ–΄λ–¤ κ°’μ νƒ€μ…μ΄ λ³€μ νƒ€μ…μ ν•μ„ νƒ€μ…μΈ κ²½μ°μ—λ§ κ°’μ„ λ³€μμ— λ€μ…ν•κ² ν—μ©ν•λ‹¤.

κ°„λ‹¨ν• κ²½μ° ν•μ„ νƒ€μ…μ€ <span style="color:orange">ν•μ„ ν΄λμ¤</span>μ™€ κ·Όλ³Έμ μΌλ΅ κ°™λ‹¤.
Int ν΄λμ¤λ” Numberμ ν•μ„ ν΄λμ¤μ΄λ―€λ΅ Intλ” Numberμ ν•μ„ νƒ€μ…μ΄λ‹¤.
Stringμ€ CharSequenceμ ν•μ„ νƒ€μ…μΈ κ²ƒμ²λΌ μ–΄λ–¤ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤μ νƒ€μ…μ€ 
κ·Έ μΈν„°νμ΄μ¤ νƒ€μ…μ ν•μ„ νƒ€μ…μ΄λ‹¤.

λ„μ΄ λ  μ μλ” νƒ€μ…μ€ ν•μ„ νƒ€μ…κ³Ό ν•μ„ ν΄λμ¤κ°€ κ°™μ§€ μ•λ‹¤.

![κ·Έλ¦Ό 9.5](/Users/barley.son/dev/WhatTheKotlinInAction/src/main/kotlin/ch9/img9-5.png)

λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ€ λ„μ΄ λ  μ μλ” νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ§€λ§ λ‘ νƒ€μ… λ¨λ‘ κ°™μ€ ν΄λμ¤μ— ν•΄λ‹Ήν•λ‹¤.
ν•­μƒ λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ κ°’μ„ λ„μ΄ λ  μ μλ” νƒ€μ…μ λ³€μμ— μ €μ¥ν•  μ μμ§€λ§, 
λ°λ€λ΅ λ„μ΄ λ  μ μλ” νƒ€μ…μ κ°’μ„ λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ λ³€μμ— μ €μ¥ν•  μλ” μ—†λ‹¤.

μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• νƒ€μ… μΈμλ΅ μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μ΄ λ“¤μ–΄κ°€λ©΄ 
μΈμ¤ν„΄μ¤ νƒ€μ… μ‚¬μ΄μ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ„±λ¦½ν•μ§€ μ•μΌλ©΄ 
κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ <span style="color:orange">λ¬΄κ³µλ³€(invariant)</span>μ΄λΌ λ§ν•λ‹¤.

MutableListλ¥Ό μλ΅ λ“¤μ–΄λ³΄μ.
Aμ™€ Bκ°€ μ„λ΅ λ‹¤λ¥΄κΈ°λ§ ν•λ©΄ `MutableList<A>`λ” ν•­μƒ `MutableList<B>`μ ν•μ„ νƒ€μ…μ΄ μ•„λ‹λ‹¤.

μ½”ν‹€λ¦°μ List μΈν„°νμ΄μ¤λ” μ½κΈ° μ „μ© μ»¬λ ‰μ…μ„ ν‘ν„ν•λ‹¤. 
Aκ°€ Bμ ν•μ„ νƒ€μ…μ΄λ©΄ `List<A>`λ” `List<B>`μ ν•μ„ νƒ€μ…μ΄λ‹¤. 
κ·Έλ° ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό κ³µλ³€μ (covariant)μ΄λΌκ³  ν•λ‹¤.


<br/>


## 9.3.3. κ³µλ³€μ„±: ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€

`Producer<T>`λ¥Ό μλ΅ κ³µλ³€μ„± ν΄λμ¤λ¥Ό μ„¤λ…ν•μ. 
Aκ°€ Bμ ν•μ„ νƒ€μ…μΌ λ• `Producer<A>`κ°€ `Producer<B>`μ ν•μ„ νƒ€μ…μ΄λ©΄ Peoducerλ” κ³µλ³€μ μ΄λ‹¤. 
μ΄λ¥Ό ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ μ§€λλ‹¤κ³  λ§ν•λ‹¤. 

- μλ¥Ό λ“¤μ–΄ Catκ°€ Animalμ ν•μ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— 
  - `Producer<Cat>`μ€ `Producer<Animal>`μ ν•μ„ νƒ€μ…μ΄λ‹¤.

μ½”ν‹€λ¦°μ—μ„ μ λ„¤λ¦­ ν΄λμ¤κ°€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ κ³µλ³€μ μ„μ„ ν‘μ‹ν•λ ¤λ©΄ 
νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ μ•μ— outμ„ λ„£μ–΄μ•Ό ν•λ‹¤.

```kotlin
interface Producer<out T> { // ν΄λμ¤κ°€ Tμ— λ€ν•΄ κ³µλ³€μ μ΄λΌ μ„ μ–Έ
    fun produce(): T
}
```

ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ 
ν•¨μ μ •μμ— μ‚¬μ©ν• νλΌλ―Έν„° νƒ€μ…κ³Ό νƒ€μ… μΈμμ νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•μ§€ μ•μ•„λ„ 
κ·Έ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό ν•¨μ μΈμλ‚ λ°ν™ κ°’μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
open class Animal {
    fun feed() { ... }
}

class Herd<T: Animal> { // μ΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ¬΄κ³µλ³€μ„±μΌλ΅ μ§€μ •
    val size: Int get() = ...
    operator fun get(i: Int): T { ... }
}

fun feedAll(animals: Herd<Animal>) {
    for(i in 0 until animals.size) {
        animals[i].feed()
    }
}
```

μ‚¬μ©μ μ½”λ“κ°€ κ³ μ–‘μ΄ λ¬΄λ¦¬λ¥Ό λ§λ“¤μ–΄μ„ κ΄€λ¦¬ν•λ‹¤λ©΄...

```kotlin
class Cat : Animal() { // Catμ€ Animalμ΄λ‹¤
    fun cleanLitter() { ... }
}

fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0 until cats.size) {
        cats[i].cleanLitter()

      /**
       * ERROR: Type mismatch: inferred type is Herd<Cat>, but Herd<Animal> was expected
       */
      // feedAll(cats)
    }
}
```

feedAll ν•¨μμ—κ² κ³ μ–‘μ΄ λ¬΄λ¦¬λ¥Ό λ„κΈ°λ©΄ νƒ€μ… λ¶μΌμΉ(type mismatch) μ¤λ¥λ¥Ό λ³Ό μ μλ‹¤. 
Herd ν΄λμ¤μ T νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ μ•„λ¬΄ λ³€μ„±λ„ μ§€μ •ν•μ§€ μ•μ•κΈ° λ•λ¬Έμ— 
κ³ μ–‘μ΄ λ¬΄λ¦¬λ” λ™λ¬Ό λ¬΄λ¦¬μ ν•μ„ ν΄λμ¤κ°€ μ•„λ‹λ‹¤.

Herd ν΄λμ¤λ” Listμ™€ λΉ„μ·ν• APIλ¥Ό μ κ³µν•λ©° λ™λ¬Όμ„ κ·Έ ν΄λμ¤μ— μ¶”κ°€ν•κ±°λ‚ 
λ¬΄λ¦¬μ•μ λ™λ¬Όμ„ λ‹¤λ¥Έ λ™λ¬Όλ΅ λ°”κΏ€ μλ” μ—†λ‹¤. 
λ”°λΌμ„ Herdλ¥Ό κ³µλ³€μ μΈ ν΄λμ¤λ΅ λ§λ“¤κ³  νΈμ¶ μ½”λ“λ¥Ό μ μ ν λ°”κΏ€ μ μλ‹¤.

```kotlin
class Herd<out T : Animal> { // Tλ” μ΄μ  κ³µλ³€μ   
   // ...
}

fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0 until cats.size) {
        cats[i].cleanLitter()
    }
    feedAll(cats) // μΊμ¤ν…μ„ ν•  ν•„μ”κ°€ μ—†λ‹¤
}
```

λ¨λ“  ν΄λμ¤λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤ μλ” μ—†λ‹¤.
- κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄
  - μ•μ „ν•μ§€ λ»ν• ν΄λμ¤λ„ μκΈ° λ•λ¬Έμ΄λ‹¤.
- νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ μ§€μ •ν•λ©΄ 
  - ν΄λμ¤ λ‚΄λ¶€μ—μ„ κ·Έ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ„ μ ν•ν•λ‹¤.

νƒ€μ… μ•μ •μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ κ³µλ³€μ  νλΌλ―Έν„°λ” ν•­μƒ out μ„μΉμ—λ§ μμ–΄μ•Ό ν•λ‹¤.
ν΄λμ¤ T νƒ€μ…μ κ°’μ„ μƒμ‚°ν•  μλ” μμ§€λ§ μ†λΉ„ν•  μλ” μ—†λ‹¤.

ν΄λμ¤ λ©¤λ²„λ¥Ό μ„ μ–Έν•  λ• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ” μ§€μ μ€ λ¨λ‘ μΈ(in)κ³Ό μ•„μ›ƒ(out)μ„μΉλ΅ λ‚λ‰λ‹¤.
TλΌλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό μ„ μ–Έν•κ³  Tλ¥Ό μ‚¬μ©ν•λ” ν•¨μκ°€ λ©¤λ²„λ΅ μλ” ν΄λμ¤λ¥Ό μƒκ°ν•΄λ³΄μ.
- Tκ°€ ν•¨μμ λ°ν™ νƒ€μ…μ— μ“°μ΄λ©΄ Tλ” out μ„μΉμ— μκ³ , 
  - κ·Έ ν•¨μλ” T νƒ€μ…μ κ°’μ„ μƒμ‚°ν•λ‹¤.
- Tκ°€ ν•¨μμ νλΌλ―Έν„° νƒ€μ…μ— μ“°μ΄λ©΄ in μ„μΉμ— μκ³ , 
  - κ·Έ ν•¨μλ” T νƒ€μ…μ κ°’μ„ μ†λΉ„ν•λ‹¤.

![κ·Έλ¦Ό 9.6](/Users/barley.son/dev/WhatTheKotlinInAction/src/main/kotlin/ch9/img9-6.png)

- ν΄λμ¤ νƒ€μ… νλΌλ―Έν„° T μ•μ— out ν‚¤μ›λ“λ¥Ό λ¶™μ΄λ©΄ 
  - ν΄λμ¤ μ•μ—μ„ Tλ¥Ό μ‚¬μ©ν•λ” λ©”μ†λ“κ°€ out μ„μΉμ—μ„λ§ Tλ¥Ό μ‚¬μ©ν•κ² ν—μ©ν•κ³  
  - in μ„μΉμ—μ„λ” μ‚¬μ©ν•μ§€ λ»ν•κ² λ§‰λ”λ‹¤.

out ν‚¤μ›λ“λ” Tμ μ‚¬μ©λ²•μ„ μ ν•ν•λ©° Tλ΅ μΈν•΄ μƒκΈ°λ” ν•μ„ νƒ€μ… κ΄€κ³„μ νƒ€μ… μ•μ •μ„±μ„ λ³΄μ¥ν•λ‹¤.

```kotlin
class Herd<out T: Animal> { 
    val size: Int get() = ...
    operator fun get(i: Int): T { ... } // Tλ¥Ό λ°ν™νƒ€μ…μΌλ΅ μ‚¬μ©ν•λ‹¤
} 
```

Catμ΄ Animalμ ν•μ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— `Herd<Animal>`μ€ getμ„ νΈμ¶ν•λ” λ¨λ“  μ½”λ“λ” 
getμ΄ Catμ„ λ°ν™ν•΄λ„ μ•„λ¬΄ λ¬Έμ  μ—†μ΄ μ‘λ™ν•λ‹¤.

- κ³µλ³€μ„±: ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ μ§€λλ‹¤(`Producer<Cat>`μ€ `Producer<Animal>`μ ν•μ„νƒ€μ…μ΄λ‹¤)
- μ‚¬μ© μ ν•: Tλ¥Ό μ•„μ›ƒ μ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤

```kotlin
interface List<out T>: Collection<T> {
    // μ½κΈ° μ „μ© λ©”μ†λ“λ΅ Tλ¥Ό λ°ν™ν•λ” λ©”μ†λ“λ§ μ •μν•λ‹¤.
    // (λ”°λΌμ„ Tλ” ν•­μƒ μ•„μ›ƒ μ„μΉμ— μ“°μΈλ‹¤.)
    operator fun get(index: Int): T 
    // ...
}
```

νƒ€μ… νλΌλ―Έν„°λ¥Ό...
- ν•¨μμ νλΌλ―Έν„° νƒ€μ…μ΄λ‚
- λ°ν™ νƒ€μ…,
- κ·Έλ¦¬κ³  λ‹¤λ¥Έ νƒ€μ…μ νƒ€μ… μΈμλ΅ μ‚¬μ©ν•  μλ„ μλ‹¤

```kotlin
interface List<out T>: Collection<T> {
    // μ—¬κΈ°μ„λ„ Tλ” μ•„μ›ƒ μ„μΉμ— μλ‹¤
    fun subList(fromIndex: Int, toIndex: Int): List<T> 
    // ...
}
```

`MutableList<T>`μ κ²½μ° νƒ€μ…νλΌλ―Έν„° Tμ— λ€ν•΄ κ³µλ³€μ μΌλ΅ μ„ μ–Έν•  μ μ—†λ‹¤.
`MutableList<T>`μ—λ” Tλ¥Ό μΈμλ΅ λ°›μ•„μ„ κ·Έ νƒ€μ…μ κ°’μ„ λ°ν™ν•λ” λ©”μ†λ“κ°€ μλ‹¤.
(λ”°λΌμ„ Tκ°€ μΈκ³Ό μ•„μ›ƒμ— λ™μ‹μ— μ“°μΈλ‹¤.)

```kotlin
// MutableListλ” Tμ— λ€ν•΄ κ³µλ³€μ μΌ μ μ—†λ‹¤.
interface MutableList<T> :List<T>, MutableCollection<T> {
    // μ΄μ λ” Tκ°€ μΈ μ„μΉμ— μ“°μ΄κΈ° λ•λ¬Έ
    @override fun add(element: T): Boolean
}
```

μ»΄νμΌλ¬λ” νƒ€μ… νλΌλ―Έν„°κ°€ μ“°μ΄λ” μ„μΉλ¥Ό μ ν•ν•λ‹¤. ν΄λμ¤κ°€ κ³µλ³€μ μΌλ΅ μ„ μ–Έλ κ²½μ° 
`Type parametr T is declared as 'out' but occurs in 'in' position` μ¤λ¥λ¥Ό λ³΄κ³ ν•λ‹¤.
(νƒ€μ… νλΌλ―Έν„° Tκ°€ μ•„μ›ƒμΌλ΅ μ„ μ–Έλμ§€λ§ μΈ μ„μΉμ— λ‚νƒ€λ‚¨)

μƒμ„±μ νλΌλ―Έν„°λ” μΈμ΄λ‚ μ•„μ›ƒ, μ–΄λ μ½λ„ μ•„λ‹λΌλ” μ‚¬μ‹¤μ— μ μν•λ‹¤.
νƒ€μ… νλΌλ―Έν„°κ°€ μ•„μ›ƒμ΄λΌ ν•΄λ„ κ·Έ νƒ€μ…μ„ μ—¬μ „ν μƒμ„±μ νλΌλ―Έν„° μ„ μ–Έμ— μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
class Herd<out T: Animal>(vararg animals: T) { ... }
```

λ³€μ„±μ€ μ½”λ“μ—μ„ μ„ν—ν•  μ—¬μ§€κ°€ μλ” λ©”μ†λ“λ¥Ό νΈμ¶ν•  μ μ—†κ² λ§λ“¦μΌλ΅μ¨ 
μ λ„¤λ¦­νƒ€μ…μ μΈμ¤ν„΄μ¤ μ—­ν• μ„ ν•λ” ν΄λμ¤ μΈμ¤ν„΄μ¤λ¥Ό μλ» μ‚¬μ©ν•λ” μΌμ΄ μ—†κ² λ°©μ§€ν•λ” μ—­ν• μ„ ν•λ‹¤. 
μƒμ„±μλ” λ‚μ¤‘μ— νΈμ¶ν•  μ μλ” λ©”μ†λ“κ°€ μ•„λ‹λ‹¤. λ”°λΌμ„ μƒμ„±μλ” μ„ν—ν•  μ—¬μ§€κ°€ μ—†λ‹¤. 

ν•μ§€λ§ μƒμ„±μμ— valμ΄λ‚ varν‚¤μ›λ“λ¥Ό μ λ”λ‹¤λ©΄ κ²ν„°λ‚ μ„Έν„°λ¥Ό μ •μν•λ”κ²ƒκ³Ό κ°™μΌλ―€λ΅ 
μ½κΈ° μ „μ© ν”„λ΅νΌν‹°λ” μ•„μ›ƒ μ„μΉ, λ³€κ²½ κ°€λ¥ ν”„λ΅νΌν‹°λ” μ•„μ›ƒκ³Ό μΈμ„μΉ λ¨λ‘μ— ν•΄λ‹Ήν•λ‹¤.

λν• μ•„λ μμ‹λ” loadAnimal ν”„λ΅νΌν‹°κ°€ μΈμ„μΉμ— μκΈ° λ•λ¬Έμ— Tλ¥Ό μ•„μ›ƒ μ„μΉμ— ν‘μ‹ν•  μ μ—†λ‹¤.

```kotlin
class Herd<T: Animal>(var leadAnimal: T, vararg animals: T) { ... }
```

T νƒ€μ…μΈ leadAnimal ν”„λ΅νΌν‹°κ°€ in μ„μΉμ— μκΈ° λ•λ¬Έμ— Tλ¥Ό outμΌλ΅ ν‘μ‹ν•  μ μ—†λ‹¤.
(ν•„μ : μ΄κ² λ¬΄μ¨ λ§μ΄μ•Ό...)

λν• μ΄λ° μ„μΉ κ·μΉ™μ€ μ¤μ§ μ™Έλ¶€μ—μ„ λ³Ό μ μλ” ν΄λμ¤ APIμ—λ§ μ μ©ν•  μ μλ‹¤.
λΉ„κ³µκ° λ©”μ†λ“μ νλΌλ―Έν„°λ” inλ„ μ•„λ‹κ³  outλ„ μ•„λ‹ μ„μΉμ΄λ‹¤.
λ³€μ„± κ·μΉ™μ€ ν΄λμ¤ μ™Έλ¶€μ μ‚¬μ©μκ°€ ν΄λμ¤λ¥Ό μλ» μ‚¬μ©ν•λ” μΌμ„ λ§‰κΈ° μ„ν• κ²ƒμ΄λ―€λ΅ 
ν΄λμ¤ λ‚΄λ¶€ κµ¬ν„μ—λ” μ μ©λμ§€ μ•λ”λ‹¤.

<br/>

## 9.3.4. λ°κ³µλ³€μ„±: λ’¤μ§‘ν ν•μ„ νƒ€μ… κ΄€κ³„

λ°κ³µλ³€μ„±μ€ κ³µλ³€μ„±μ„ κ±°μΈμ— λΉ„μΉ μƒμ΄λΌ ν•  μ μλ‹¤.
λ°κ³µλ³€ ν΄λμ¤μ ν•μ„ νƒ€μ… κ΄€κ³„λ” κ³µλ³€ ν΄λμ¤μ κ²½μ°μ™€ λ°λ€μ΄λ‹¤.

```kotlin
interface Comparator<in T> {
    fun compare(e1: T, e2: T): Int { ... } // Tλ¥Ό μΈ μ„μΉμ— μ‚¬μ©ν•λ‹¤
}
```

μ΄ μΈν„°νμ΄μ¤μ λ©”μ†λ“λ” T νƒ€μ…μ κ°’μ„ μ†λΉ„ν•κΈ°λ§ ν•λ‹¤. 
μ΄λ” Tκ°€ in μ„μΉμ—μ„λ§ μ“°μΈλ‹¤λ” λ»μ΄λ‹¤.

λ¬Όλ΅  νΉμ • νƒ€μ…μ— Comparatorμ„ κµ¬ν„ν•λ©΄, κ·Έ νƒ€μ…μ ν•μ„ νƒ€μ…μ— μ†ν•λ” λ¨λ“  κ°’μ„ λΉ„κµν•  μ μλ‹¤.

```kotlin
val anyComparator = Comparator<Any> { 
    e1, e2 -> e1.hashCode() - e2.hashCode()
}

val strings: listOf<String> = ...
// λ¬Έμμ—΄κ³Ό κ°™μ€ κµ¬μ²΄μ μΈ νƒ€μ…μ„ λΉ„κµν•λ”λ° λ¨λ“  κ°μ²΄λ¥Ό λΉ„κµν•λ” Comparatorμ„ μ‚¬μ©ν•  μ μλ‹¤.
strings.sortedWith(anyComparator)
```

sortedWithλ” `Comparator<String>`μ„ μ”κµ¬ν•λ―€λ΅,
Stringλ³΄λ‹¤ λ” μΌλ°μ μΈ νƒ€μ…μ„ λΉ„κµν•  μ μλ” Comparatorμ„ sortedWithμ— λ„κ²¨μ£Όλ” κ²ƒμ€ μ•μ „ν•λ‹¤
μ–΄λ–¤ νƒ€μ…μ κ°μ²΄λ¥Ό Comparatorλ΅ λΉ„κµν•΄μ•Ό ν•λ‹¤λ©΄
κ·Έ νƒ€μ…μ΄λ‚ μ΅°μƒ νƒ€μ…μ„ λΉ„κµν•  μ μλ” Comparatorμ„ μ‚¬μ©ν•  μ μλ‹¤.
μ΄λ” `Comparator<Any>`κ°€ `Comparator<String>`μ΄λΌλ” λ».
ν•μ§€λ§ Anyλ” Stringμ ν•μ„ νƒ€μ…μ΄λ‹¤. 
μ„λ΅ λ‹¤λ¥Έ νƒ€μ… μΈμμ— λ€ν•΄ Comparatorμ νƒ€μ… κ΄€κ³„λ” νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„μ™€λ” μ •λ°λ€ λ°©ν–¥μ΄λ‹¤.

Consumer<T>λ¥Ό μλ΅ λ“¤μ–΄λ³΄μ.
νƒ€μ… Bκ°€ νƒ€μ… Aμ ν•μ„ νƒ€μ…μΈ κ²½μ° `Consumer<A>`κ°€ `Consumer<B>`μ ν•μ„ νƒ€μ…μΈ κ΄€κ³„κ°€ μ„±λ¦½ν•λ©΄ 
μ λ„¤λ¦­ ν΄λμ¤ Consumer<T>λ” νƒ€μ… μΈμ Tμ— λ°κ³µλ³€μ΄λ‹¤.
Aμ™€ Bμ μ„μΉκ°€ μ„λ΅ λ’¤λ°”λ€λ‹¤. **ν•μ„ νƒ€μ… κ΄€κ³„κ°€ λ’¤μ§‘νλ‹¤.**

![κ·Έλ¦Ό 9.7](/Users/barley.son/dev/WhatTheKotlinInAction/src/main/kotlin/ch9/img9-7.png)

in ν‚¤μ›λ“λ” κ·Έ ν‚¤μ›λ“κ°€ λ¶™μ€ νƒ€μ…μ΄ λ©”μ†λ“ μ•μΌλ΅ μ „λ‹¬λμ–΄ μ†λΉ„λλ‹¤λ” λ».
κ³µλ³€μ„±μ κ²½μ°μ™€ λ§μ°¬κ°€μ§€λ΅ νƒ€μ… νλΌλ―Έν„°μ μ‚¬μ©μ„ μ ν•ν•¨μΌλ΅μ¨ νΉμ • ν•μ„ νƒ€μ…κ΄€ κ΄€κ³„μ— λ„λ‹¬ν•  μ μλ‹¤.

|κ³µλ³€μ„±|λ°κ³µλ³€μ„±|λ¬΄κ³µλ³€μ„±|
|---|---|---
|`Producer<out T>`|`Consumer<in T>`|`MutableList<T>`|
|νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ λ„¤λ¦­ νƒ€μ…μ—μ„λ„ μ μ§€λλ‹¤| νƒ€μ…μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ λ„¤λ¦­ νƒ€μ…μ—μ„ λ’¤μ§‘νλ‹¤|ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ„±λ¦½ν•μ§€ μ•λ”λ‹¤|
|`Producer<Cat>`μ€ `Producer<Animal>`μ ν•μ„νƒ€μ…μ΄λ‹¤|`Consumer<Animal>`μ€ `Consumer<Cat>`μ ν•μ„νƒ€μ…μ΄λ‹¤||
|Tλ¥Ό μ•„μ›ƒ μ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤| Tλ¥Ό μΈμ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤|Tλ¥Ό μ•„λ¬΄μ„μΉμ—μ„λ‚ μ‚¬μ©ν•  μ μλ‹¤|

ν΄λμ¤λ‚ μΈν„°νμ΄μ¤κ°€ νΉμ • νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” 
κ³µλ³€μ μ΄κ³  λ‹¤λ¥Έ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” λ°κ³µλ³€μ μΌ μλ„ μλ‹¤.

```kotlin
interface Function1<in P, out R>{
    operator fun invoke(p: P): R
}
```

(P) -> Rμ€ `Function<P, R>`μ„ λ” μ•μ•„λ³΄κΈ° μ‰½κ² μ μ€ κ²ƒμ΄λ‹¤.

Function1μ ν•μ„ νƒ€μ… κ΄€κ³„λ”
- μ²«λ²μ§Έ νƒ€μ… μΈμμ ν•μ„ νƒ€μ…κ΄€κ³„μ™€λ” λ°λ€μ§€λ§
- λ‘λ²μ§Έ νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„μ™€λ” κ°™μμ„ λ»ν•λ‹¤.

```kotlin
fun enumerateCats(f: (Cat) -> Number){ ... }
fun Animal.getIndex(): Int = ...

// Animalμ€ Catμ μƒμ„ νƒ€μ…μ΄λ©° Intλ” Numberμ ν•μ„ νƒ€μ…μ΄λ―€λ΅
// μ΄ μ½”λ“λ” μ¬λ°”λ¥Έ μ½”ν‹€λ¦° μ‹μ΄λ‹¤.
>>> enumerateCats(Animal::birthDay)
```

ν΄λμ¤ μ •μμ— λ³€μ„±μ„ μ§μ ‘ κΈ°μ ν•λ©΄
κ·Έ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ¥μ†μ— κ·Έ λ³€μ„±μ΄ μ μ©λλ‹¤λ” μ .
μλ°”λ” μ΄λ¥Ό μ§€μ›ν•μ§€ μ•λ”λ‹¤. 
λ€μ‹  ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” μ„μΉμ—μ„ μ™€μΌλ“ μΉ΄λ“λ¥Ό μ‚¬μ©ν•΄ κ·Έλ•κ·Έλ• λ³€μ„±μ„ μ§€μ •ν•΄μ•Ό ν•λ‹¤.


<br/>


## 9.3.5. μ‚¬μ© μ§€μ  λ³€μ„±: νƒ€μ…μ΄ μ–ΈκΈ‰λλ” μ§€μ μ—μ„ λ³€μ„± μ§€μ •

ν΄λμ¤λ¥Ό μ„ μ–Έν•λ©΄μ„ λ³€μ„±μ„ μ§€μ •ν•λ©΄ 
κ·Έ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ¥μ†μ— λ³€μ„± μ§€μ •μκ°€ μν–¥μ„ λΌμΉλ―€λ΅ νΈλ¦¬ν•λ‹¤. μ΄λ¬ν• λ°©μ‹μ„ 
<span style="color:orange">μ„ μ–Έ μ§€μ  λ³€μ„±(declaration site variance)</span>μ΄λΌ ν•λ‹¤.
μλ°”λ” λ³€μ„±μ„ λ‹¤λ¥Έ λ°©μ‹μΌλ΅ λ‹¤λ£¨λ”λ°, νƒ€μ… νλΌλ―Έν„°κ°€ μλ” νƒ€μ…μ„ μ‚¬μ©ν•  λ•λ§λ‹¤ 
ν•΄λ‹Ή νƒ€μ… νλΌλ―Έν„°λ¥Ό ν•μ„ νƒ€μ…μ΄λ‚ μƒμ„ νƒ€μ… μ¤‘ μ–΄λ–¤ νƒ€μ…μΌλ΅ λ€μΉν•  μ μλ”μ§€ λ…μ‹ν•΄μ•Ό ν•λ‹¤. μ΄λ° λ°©μ‹μ„
<span style="color:orange">μ‚¬μ© μ§€μ  λ³€μ„±(use site variance)</span>μ΄λΌ ν•λ‹¤.

> ### β… μ½”ν‹€λ¦° μ„ μ–Έ μ§€μ  λ³€μ„±κ³Ό μλ°” μ™€μΌλ“μΉ΄λ“ λΉ„κµ
> μ„ μ–Έ μ§€μ  λ³€μ„±μ„ μ‚¬μ©ν•λ©΄ λ³€μ„± λ³€κ²½μλ¥Ό λ‹¨ ν•λ²λ§ ν‘μ‹ν•κ³ 
> ν΄λμ¤λ¥Ό μ“°λ” μ½μ—μ„λ” λ³€μ„±μ— λ€ν•΄ μ‹ κ²½μ“Έ ν•„μ”κ°€ μ—†μΌλ―€λ΅ μ½”λ“κ°€ λ” κ°„κ²°ν•΄μ§„λ‹¤.
> μλ°”μ—μ„ μ‚¬μ©μμ μμƒλ€λ΅ μ‘λ™ν•λ” APIλ¥Ό λ§λ“¤κΈ° μ„ν•΄ λΌμ΄λΈλ¬λ¦¬ κ°λ°μλ”
> `Function<? super T, ? extends R>`μ²λΌ μ™€μΌλ“μΉ΄λ“λ¥Ό μ‚¬μ©ν•΄μ•Ό λλ‹¤.
> μλ°” 8 ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬ μ†μ¤μ½”λ“λ¥Ό μ‚΄ν΄λ³΄λ©΄ 
> Function μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ„μΉμ—μ„ μ™€μΌλ“μΉ΄λ“λ¥Ό λ³Ό μ μλ‹¤.
> 
> ```java
> public interface Stream {
>   <R> Stream <R> map(Function<? super T, ? extends R> mapper);
> }
> ```
> ν΄λμ¤ μ„ μ–Έ μ§€μ μ—μ„ λ³€μ„±μ„ ν•λ²λ§ μ§€μ •ν•λ©΄ λ” κ°„κ²° + μ°μ•„ν• μ½”λ“λ¥Ό μ‘μ„±ν•  μ μλ‹¤


μ½”ν‹€λ¦°λ„ μ‚¬μ© μ§€μ  λ³€μ„±μ„ μ§€μ›ν•λ‹¤.
λ”°λΌμ„ ν΄λμ¤ μ•μ—μ„ μ–΄λ–¤ νƒ€μ… νλΌλ―Έν„°κ°€ κ³µλ³€μ μ΄κ±°λ‚ λ°κ³µλ³€μ μΈμ§€ μ„ μ–Έν•  μ μ—†λ” κ²½μ°μ—λ„ 
νΉμ • νƒ€μ… νλΌλ―Έν„°κ°€ λ‚νƒ€λ‚λ” μ§€μ μ—μ„ λ³€μ„±μ„ μ •ν•  μ μλ‹¤.

MutableListμ™€ κ°™μ€ μƒλ‹Ήμμ μΈν„°νμ΄μ¤λ” νƒ€μ… νλΌλ―Έν„°λ΅ μ§€μ •λ νƒ€μ…μ„ μ†λΉ„ν•λ” λ™μ‹μ— μƒμ‚°ν•  μ μκΈ° λ•λ¬Έμ—
μΌλ°μ μΌλ΅ κ³µλ³€μ μ΄μ§€λ„ λ°κ³µλ³€μ μ΄μ§€λ„ μ•λ‹¤.
ν•μ§€λ§ κ·Έλ° μΈν„°νμ΄μ¤ νƒ€μ…μ λ³€μκ°€ ν• ν•¨μ μ•μ—μ„ μƒμ‚°μλ‚ μ†λΉ„μ μ¤‘ 
λ‹¨ ν• κ°€μ§€ μ—­ν• λ§μ„ λ‹΄λ‹Ήν•λ” κ²½μ°κ°€ μμ£Ό μλ‹¤.

```kotlin
fun <T> copyData(source: MutableList<T>, destination: MutableList<T>) {
    for (item in source) {
        destination.add(item)
    }
}
```

μ΄ ν•¨μλ” μ»¬λ ‰μ…μ μ›μ†λ¥Ό λ‹¤λ¥Έ μ»¬λ ‰μ…μΌλ΅ λ³µμ‚¬ν•λ”λ°, 
λ‘ μ»¬λ ‰μ… λ¨λ‘ λ¬΄κ³µλ³€ νƒ€μ…μ΄μ§€λ§ μ›λ³Έ μ»¬λ ‰μ…μ—μ„λ” μ½κΈ°λ§ ν•κ³  λ€μƒ μ»¬λ ‰μ…μ—μ„λ” μ“°κΈ°λ§ ν•λ‹¤.
λ”°λΌμ„ λ‘ μ»¬λ ‰μ…μ μ›μ† νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•  ν•„μ”κ°€ μ—†λ” κ²ƒμ΄λ‹¤.

μ΄ ν•¨μκ°€ μ—¬λ¬ λ‹¤λ¥Έ λ¦¬μ¤νΈ νƒ€μ…μ— λ€ν•΄ μ‘λ™ν•κ² ν•λ ¤λ©΄ 
λ‘ λ²μ§Έ μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ…ν•  μ μλ‹¤.

```kotlin
// source μ›μ† νƒ€μ…μ€ destination μ›μ† νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.
fun <T: R, R> copyData(source: MutableList<T>, 
                       destination: MutableList<R>) {
    for (item in source) {
        destination.add(item)
    }
}
>>> val ints = mutableListOf(1, 2, 3)
>>> val anyItems = mutableListOf<Any>()
>>> copyData(ints, anyItems) // Intκ°€ Anyμ ν•μ„ νƒ€μ…μ΄λ―€λ΅ μ΄ ν•¨μλ¥Ό νΈμ¶ν•  μ μλ‹¤.
>>> println(anyItems)
[1, 2, 3]
```

ν•¨μ κµ¬ν„μ΄ μ•„μ›ƒ μ„μΉμ— μλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ©”μ†λ“λ§ νΈμ¶ν•λ‹¤λ©΄ 
κ·Έλ° μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ ν•¨μ μ •μ μ‹ νƒ€μ… νλΌλ―Έν„°μ— λ³€μ„± λ³€κ²½μλ¥Ό μ¶”κ°€ν•  μ μλ‹¤.

```kotlin
// out ν‚¤μ›λ“λ¥Ό νƒ€μ…μ„ μ‚¬μ©ν•λ” μ„μΉ μ•μ— λ¶™μ΄λ©΄
// T νƒ€μ…μ„ in μ„μΉμ— μ‚¬μ©ν•λ” λ©”μ†λ“λ¥Ό νΈμ¶ν•μ§€ μ•λ”λ‹¤λ” λ»μ΄λ‹¤.
fun <T> copyData(source: MutableList<out T>,    
                 destination: MutableList<T>) {
    for (item in source) {
        destination.add(item)
    }
}
```

νƒ€μ… μ„ μ–Έμ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” μ„μΉλΌλ©΄ μ–΄λ””μ—λ‚ λ³€μ„± λ³€κ²½μλ¥Ό λ¶™μΌ μ μλ‹¤.
μ΄λ• <span style="color:orange">νƒ€μ… ν”„λ΅μ μ…(tyoe projection)</span>μ΄ μΌμ–΄λ‚λ‹¤.
μ¦‰ sourceλ¥Ό μΌλ°μ μΈ MutableListκ°€ μ•„λ‹ MutableListλ¥Ό ν”„λ΅μ μ… ν• νƒ€μ…μΌλ΅ λ§λ“ λ‹¤.
μ΄ κ²½μ° copyData ν•¨μλ” MutalbeListμ λ©”μ†λ“ μ¤‘μ—μ„ λ°ν™ νƒ€μ…μΌλ΅ 
νƒ€μ… νλΌλ―Έν„° Tλ¥Ό μ‚¬μ©ν•λ” λ©”μ†λ“λ§ νΈμ¶ν•  μ μλ‹¤.
μ»΄νμΌλ¬λ” νƒ€μ… νλΌλ―Έν„° Tλ¥Ό ν•¨μ μΈμ νƒ€μ…μΌλ΅ μ‚¬μ©ν•μ§€ λ»ν•κ² λ§λ“ λ‹¤.

```kotlin
val list: MutableList<out Number> = ...
list.add(42)

Error: Out-projected type 'MutableList<out Number>' prohibits
the use of 'fun add(element: E):Boolean'
```

ν”„λ΅μ μ… νƒ€μ…μ λ©”μ†λ“ μ¤‘ μΌλ¶€λ¥Ό νΈμ¶ν•μ§€ λ»ν•  λ• 
κ·Έλ° λ©”μ†λ“λ¥Ό νΈμ¶ν•κ³  μ‹¶λ‹¤λ©΄ ν”„λ΅μ μ… νƒ€μ… λ€μ‹  μΌλ° νƒ€μ…μ„ μ‚¬μ©ν•λ©΄ λλ‹¤.
μΌλ° νƒ€μ…μ„ μ‚¬μ©ν•λ©΄ κ²½μ°μ— λ”°λΌ λ‹¤λ¥Έ νƒ€μ…κ³Ό μ—°κ΄€μ΄ μλ” μƒ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ¶”κ°€ν•΄μ•Ό ν•  μλ„ μλ‹¤.

copyDataλ¥Ό μ λ€λ΅ κµ¬ν„ν•λ ¤λ©΄ List<T>λ¥Ό source μΈμμ νƒ€μ…μΌλ΅ μ •ν•λ” κ²ƒμ΄λ‹¤.
μ‹¤μ  MutableListκ°€ μ•„λ‹λΌ Listμ— μλ” λ©”μ†λ“λ§ sourceμ— λ€ν•΄ μ‚¬μ©ν•λ©΄ λκ³ 
Listμ νƒ€μ… νλΌλ―Έν„° κ³µλ³€μ„±μ€ List μ„ μ–Έμ— μλ‹¤.

List<out T>μ²λΌ out λ³€κ²½μκ°€ μ§€μ •λ νƒ€μ… νλΌλ―Έν„°λ¥Ό out ν”„λ΅μ μ…ν•λ” κ²ƒμ€ μλ―Έ μ—†λ‹¤.
μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” μ΄λ° κ²½μ° λ¶ν•„μ”ν• ν”„λ΅μ μ…μ΄λΌλ” κ²½κ³ λ¥Ό ν•λ‹¤.

```kotlin
// in ν”„λ΅μ μ… νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°μ΄ν„° λ³µμ‚¬ ν•¨μ
fun <T> copyData(source: MutableList<T>,
                 // μ›λ³Έ λ¦¬μ¤νΈ μ›μ† νƒ€μ…μ μƒμ„ νƒ€μ…μ„ λ€μƒ λ¦¬μ¤νΈ μ›μ† νƒ€μ…μΌλ΅ ν—μ©ν•λ‹¤.
                 destination: MutableList<in T>){
    for (item in source){
        destination.add(item)
    }
}
```

> μ½”ν‹€λ¦°μ μ‚¬μ© μ§€μ  λ³€μ„± μ„ μ–Έμ€ μλ°”μ ν•μ • μ™€μΌλ“μΉ΄λ“μ™€ λ‘κ°™λ‹¤.
> - μ½”ν‹€λ¦°
>   - MutableList<out T>
>   - MutableList<in T>
> - μλ°”
>   - MutableList<? extends T>
>   - MutableList<? super T>

<br/>



## 9.3.6. μ¤νƒ€ ν”„λ΅μ μ…: νƒ€μ… μΈμ λ€μ‹  * μ‚¬μ©

μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄κ°€ μ—†μμ„ ν‘ν„ν•κΈ° μ„ν•΄ μ¤νƒ€ ν”„λ΅μ μ…(star projection)μ„ μ‚¬μ©ν•λ‹¤.
μλ¥Ό λ“¤μ–΄ μ›μ† νƒ€μ…μ΄ μ•λ ¤μ§€μ§€ μ•μ€ λ¦¬μ¤νΈλ” `List<*>`λΌλ” κµ¬λ¬ΈμΌλ΅ ν‘ν„ν•  μ μλ‹¤.

μ²«μ§Έ, 
`MutableList<*>`λ” `MutableList<Any?>`μ™€ κ°™μ§€ μ•λ‹¤.
`MutableList<Any?>`λ” λ¨λ“  νƒ€μ…μ μ›μ†λ¥Ό λ‹΄μ„ μ μλ‹¤λ” μ‚¬μ‹¤μ„ μ• μ μλ” λ¦¬μ¤νΈλ‹¤. 
λ°λ©΄ `MutableList<*>`λ” μ–΄λ–¤ μ •ν•΄μ§„ κµ¬μ²΄μ μΈ νƒ€μ…μ μ›μ†λ§μ„ λ‹΄λ” λ¦¬μ¤νΈμ§€λ§ 
κ·Έ μ›μ†μ νƒ€μ…μ„ μ •ν™•ν λ¨λ¥Έλ‹¤λ” μ‚¬μ‹¤μ„ ν‘ν„ν•λ‹¤.
νƒ€μ…μ΄ μ •ν•΄μ§€μ§€ μ•μ•μ„ λΏμ΄μ§€ λ¨λ“  νƒ€μ…μ„ λ‹΄μ„μ μλ” κ²ƒμ΄ μ•„λ‹κ³  
μ›μ†μ νƒ€μ…μ€ Any?(μµμƒμ„)μ ν•μ„ νƒ€μ…μ΄λ€κ°„ λ¶„λ…ν•λ‹¤.


```kotlin
>>> val list: MutableList<Any?> = mutableListOf('a', 1, "qwe")
>>> val chars = mutableListOf('a', 'b', 'c')
>>> val unknownElements: MutableList<*> = // MutableList<*>λ” MutableList<Any?>μ™€ κ°™μ§€ μ•λ‹¤.
...         if (Random().nextBoolean()) list else chars
>>> unknownElements.add(42) // μ»΄νμΌλ¬λ” μ΄ λ©”μ†λ“ νΈμ¶μ„ κΈμ§€ν•λ‹¤.                              
Error: Out-projected type 'MutableList<*>' prohibits
the use of 'fun add(element: E): Boolean'
>>> println(unknownElements.first()) // μ›μ†λ¥Ό κ°€μ Έμ™€λ„ μ•μ „ν•λ‹¤. first()λ” Any? νƒ€μ…μ μ›μ†λ¥Ό λ°ν™ν•λ‹¤. 
a
```

MutableList<*>λ” MutableList<Any?>μ²λΌ λ™μ‘ν•λ‹¤. 
μ–΄λ–¤ λ¦¬μ¤νΈμ μ›μ† νƒ€μ…μ„ λ¨λ¥΄λ”λΌλ„ κ·Έ λ¦¬μ¤νΈμ—μ„ μ•μ „ν•κ² Any? νƒ€μ…μ μ›μ†λ¥Ό κΊΌλ‚΄μ¬ μλ” μμ§€λ§ 
νƒ€μ…μ„ λ¨λ¥΄λ” λ¦¬μ¤νΈμ— μ›μ†λ¥Ό λ§μλ€λ΅ λ„£μ„ μλ” μ—†λ‹¤.

> `Consumer<in T>`μ™€ κ°™μ€ λ°κ³µλ³€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν• μ¤νƒ€ ν”„λ΅μ μ…μ€ `<in Nothing>`κ³Ό λ™λ“±ν•λ‹¤.
> κ²°κ³Όμ μΌλ΅ κ·Έλ° μ¤νƒ€ ν”„λ΅μ μ…μ—μ„λ” Tκ°€ μ‹κ·Έλ‹μ²μ— λ“¤μ–΄κ°€ μλ” λ©”μ†λ“λ¥Ό νΈμ¶ν•  μ μ—†λ‹¤.
> νƒ€μ… νλΌλ―Έν„°κ°€ λ°κ³µλ³€μ΄λΌλ©΄ μ λ„¤λ¦­ ν΄λμ¤λ” μ†λΉ„μ μ—­ν• μ„ ν•λ” λ°,
> μ°λ¦¬λ” κ·Έ ν΄λμ¤κ°€ μ •ν™•ν Tμ μ–΄λ–¤ λ¶€λ¶„μ„ μ‚¬μ©ν• μ§€ μ• μ μ—†λ‹¤.
> λ”°λΌμ„ λ°κ³µλ³€ ν΄λμ¤μ— λ¬΄μ–Έκ°€λ¥Ό μ†λΉ„ν•κ² λ„κ²¨μ„λ” μ•λλ‹¤. (ν•„μ: λ­”λ§μ΄μ—¬?)

νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‹κ·Έλ‹μ²μ—μ„ μ „ν€ μ–ΈκΈ‰ν•μ§€ μ•κ±°λ‚ λ°μ΄ν„°λ¥Ό μ½κΈ°λ” ν•μ§€λ§ 
κ·Έ νƒ€μ…μ—λ” κ΄€μ‹¬μ΄ μ—†λ” κ²½μ°μ™€ κ°™μ΄ νƒ€μ… μΈμ μ •λ³΄κ°€ μ¤‘μ”ν•μ§€ μ•μ„ λ•λ„ μ¤νƒ€ ν”„λ΅μ μ… κµ¬λ¬Έμ„ μ‚¬μ©ν•  μ μλ‹¤.


```kotlin
fun printFirst(list: List<*>) { // λ¨λ“  λ¦¬μ¤νΈλ¥Ό μΈμλ΅ λ°›μ„ μ μλ‹¤. 
    if (list.isNotEmpty()) { // isNotEmpty()μ—μ„λ” μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ§€ μ•λ”λ‹¤. 
        println(list.first()) // first()λ” μ΄μ  Any?λ¥Ό λ°ν™ν•μ§€λ§ μ—¬κΈ°μ„λ” κ·Έ νƒ€μ…λ§μΌλ΅ μ¶©λ¶„ν•λ‹¤. 
    }
}
>>> printFirst(listOf("Svetlana", "Dmitry"))
Svetlana
```

μ‚¬μ© μ§€μ  λ³€μ„±κ³Ό λ§μ°¬κ°€μ§€λ΅ μ΄λ° μ¤νƒ€ ν”„λ΅μ μ…λ„ μ°νν•λ” λ°©λ²•μ΄ μλ”λ°, 
μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ…ν•λ©΄ λλ‹¤.

```kotlin
fun <T> printFirst(list: List<T>) { // μ΄ κ²½μ°μ—λ„ λ¨λ“  λ¦¬μ¤νΈλ¥Ό μΈμλ΅ λ°›μ„ μ μλ‹¤
    if(list.isNotEmpty()) {
        println(list.first()) // μ΄μ  firstλ” T νƒ€μ…μ κ°’μ„ λ°ν™ν•λ‹¤.
    } 
}
```

μ¤νƒ€ ν”„λ΅μ μ…μ„ μ“°λ” μ½μ— λ” κ°„κ²°ν•μ§€λ§ 
μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°κ°€ μ–΄λ–¤ νƒ€μ…μΈμ§€ κµ³μ΄ μ• ν•„μ”κ°€ μ—†μ„ λ•λ§ μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•  μ μλ‹¤.
μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•  λ•λ” κ°’μ„ λ§λ“¤μ–΄λ‚΄λ” λ©”μ†λ“λ§ νΈμ¶ν•  μ μκ³  κ·Έ κ°’μ νƒ€μ…μ—λ” μ‹ κ²½μ„ μ“°μ§€ λ§μ•„μ•Ό ν•λ‹¤.

μ¤νƒ€ ν”„λ΅μ μ…μ„ μ“°λ” λ°©λ²•κ³Ό ν•¨μ •μ„ λ³΄μ—¬μ£Όλ” μμ λ¥Ό μ‚΄ν΄λ³΄μ. 
FiledValidatorμ—λ” μΈ μ„μΉμ—λ§ μ“°μ΄λ” νƒ€μ… νλΌλ―Έν„°κ°€ μλ‹¤. λ”°λΌμ„ FiledValidatorλ” λ°κ³µλ³€μ„±μ΄λ‹¤.
μ‹¤μ λ΅ String νƒ€μ…μ ν•„λ“λ¥Ό κ²€μ¦ν•κΈ° μ„ν•΄ Any νƒ€μ…μ„ κ²€μ¦ν•λ” FiledValidatorλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
interface FiledValidator<in T>{ // Tμ— λ€ν•΄ λ°κ³µλ³€μΈ μΈν„°νμ΄μ¤λ¥Ό μ„ μ–Έ
    fun validator(input: T): Boolean // Tλ¥Ό μΈ μ„μΉμ—λ§ μ‚¬μ©ν•λ‹¤.(μ΄ λ©”μ†λ“λ” T νƒ€μ…μ κ°’μ„ μ†λΉ„)
}

object DefaultStringValidator: FiledValidator<String>{
    override fun validator(input: String): Boolean  = input.isNotEmpty()
}

object DefaultIntValidator: FiledValidator<Int>{
    override fun validator(input: Int): Boolean = input >= 0
}
```

λ¨λ“  κ²€μ¦κΈ°λ¥Ό ν• μ»¨ν…μ΄λ„μ— λ„£κ³  μ…λ ¥ ν•„λ“μ νƒ€μ…μ— λ”°λΌ μ μ ν• κ²€μ¦κΈ°λ¥Ό κΊΌλ‚΄μ„ μ‚¬μ©ν•λ” κ²½μ°λ¥Ό μƒκ°ν•΄λ³΄μ.
λ¨λ“  νƒ€μ…μ κ²€μ¦κΈ°λ¥Ό λ§µμ— λ„£μ„ μ μμ–΄μ•Ό ν•λ―€λ΅ KClassλ¥Ό ν‚¤λ΅ ν•κ³ 
`FiledValidator<*>`λ¥Ό κ°’μΌλ΅ ν•λ” λ§µμ„ μ„ μ–Έν•λ‹¤.

```kotlin
val validators = mutableMapOf<KClass<*>, FiledValidator<*>>()
validators[String::class] = DefaultStringValidator
validators[Int::class] =  DefaultIntValidator   
```

λ¬Έμ κ°€ μƒκΈ΄λ‹¤. String νƒ€μ…μ ν•„λ“λ¥Ό `FiledValidator<*>` νƒ€μ…μ κ²€μ¦κΈ°λ΅ κ²€μ¦ν•  μ μ—†λ‹¤.
μ»΄νμΌλ¬λ” `FiledValidator<*>`κ°€ μ–΄λ–¤ νƒ€μ…μ„ κ²€μ¦ν•λ” κ²€μ¦κΈ°μΈμ§€ λ¨λ¥΄κΈ° λ•λ¬Έμ—
Stringμ„ κ²€μ¦ν•κΈ° μ„ν•΄ κ·Έ κ²€μ¦κΈ°λ¥Ό μ‚¬μ©ν•λ©΄ μ•μ „ν•μ§€ μ•λ‹¤κ³  νλ‹¨ν•λ‹¤.

```kotlin
// Warning: unchecked cast (κ²½κ³ : μ•μ „ν•μ§€ μ•μ€ μΊμ¤ν…)
val stringValidator = validators[String::class] as FiledValidator<String>
println(stringValidator.validate(""))
```

μ»΄νμΌλ¬λ” νƒ€μ… μΊμ¤ν…μ΄ μ•μ „ν•μ§€ λ»ν•λ‹¤κ³  κ²½κ³ ν•λ‹¤.
λν• νƒ€μ… μΊμ¤ν… λ¶€λ¶„μ—μ„ μ‹¤ν¨ν•μ§€ μ•κ³  κ°’μ„ κ²€μ¦ν•λ” λ©”μ†λ“ μ•μ—μ„ μ‹¤ν¨ν•λ‹¤.
μ‹¤ν–‰μ‹μ μ— λ¨λ“  μ λ„¤λ¦­ νƒ€μ… μ •λ³΄λ” μ‚¬λΌμ§€λ―€λ΅
νƒ€μ… μΊμ¤ν…μ€ λ¬Έμ κ°€ μ—†κ³  κ²€μ¦ λ©”μ†λ“ μ•μ—μ„ κ°’μ λ©”μ†λ“λ‚ ν”„λ΅νΌν‹°λ¥Ό μ‚¬μ©ν•  λ• λ¬Έμ κ°€ μƒκΈ΄λ‹¤. 

```kotlin
// Warning: unchecked cast (κ²½κ³ : μ•μ „ν•μ§€ μ•μ€ μΊμ¤ν…)
val stringValidator = validators[String::class] as FiledValidator<String>
println(stringValidator.validate(""))
```

μ•„λ μ½”λ“λ” validators λ§µμ„ μ‚¬μ©ν•μ§€λ§ κ²€μ¦κΈ°λ¥Ό λ“±λ΅ν•κ±°λ‚ κ°€μ Έμ¤λ” μ‘μ—…μ„ μν–‰ν•  λ•
νƒ€μ…μ„ μ λ€λ΅ κ²€μ‚¬ν•κ² μΊ΅μν™”ν•λ‹¤.
μ•μ „ν•μ§€ μ•μ€ μΊμ¤ν… μ¤λ¥λ¥Ό μ»΄νμΌ μ‹ λ°μƒμ‹ν‚¤μ§€λ§
Validators κ°μ²΄κ°€ λ§µμ— λ€ν• μ ‘κ·Όμ„ ν†µμ ν•κΈ° λ•λ¬Έμ— λ§µμ— μλ»λ κ°’μ΄ λ“¤μ–΄κ°€μ§€ λ»ν•κ² λ§‰μ„ μ μλ‹¤.

```kotlin
object Validators {
    // μ• μμ μ™€ κ°™μ€ λ§µμ„ μ‚¬μ©ν•μ§€λ§ μ™Έλ¶€μ—μ„ μ΄ λ§µμ— μ ‘κ·Όν•  μ μ—†λ‹¤.
    private val validators =
        mutableMapOf<KClass<*>, FiledValidator<*>>()

    fun <T : Any> registerValidator(
        kClass: KClass<T>, filedValidator: FiledValidator<T>
    ) {
        // μ–΄λ–¤ ν΄λμ¤μ™€ κ²€μ¦κΈ°κ°€ νƒ€μ…μ΄ λ§μ•„ λ–¨μ–΄μ§€λ” κ²½μ°μ—λ§ κ·Έ ν΄λμ¤μ™€
        // κ²€μ¦κΈ° μ •λ³΄λ¥Ό λ§µμ— ν‚¤/κ°’ μμΌλ΅ λ„£λ”λ‹¤.
        validators[kClass] = filedValidator
    }

    // FiledValidator<T> μΊμ¤ν…μ΄ μ•μ „ν•μ§€ μ•λ‹¤λ” κ²½κ³ λ¥Ό λ¬΄μ‹ν•κ² λ§λ“ λ‹¤.
    @Suppress("UNCHECKED_CAST") // κ²½κ³ λ¬΄μ‹.
    operator fun <T : Any> get(kClass: KClass<T>): FiledValidator<T> =
        validators[kClass] as? FiledValidator<T>
        ?: throw IllegalArgumentException("No validator for ${kClass.simpleName}")
}

Validators.registerValidator(String::class, DefaultStringValidator)
Validators.registerValidator(Int::class, DefaultIntValidator)
println(Validators[String::class].validate("kotlin"))
println(Validators[Int::class].validate(0))

// Result
true
ture
```

Validators κ°μ²΄μ— μλ” μ λ„¤λ¦­ λ©”μ†λ“μ—μ„ κ²€μ¦κΈ°μ™€ ν΄λμ¤μ νƒ€μ… μΈμκ°€ κ°™κΈ° λ•λ¬Έμ—
μ»΄νμΌλ¬κ°€ νƒ€μ…μ΄ μΌμΉν•μ§€ μ•λ” ν΄λμ¤μ™€ κ²€μ¦κΈ°λ¥Ό λ“±λ΅ν•μ§€ λ»ν•κ² λ§‰λ”λ‹¤.




<br/>
<br/>
<br/>



## 9.4. μ”μ•½

- μ½”ν‹€λ¦° μ λ„¤λ¦­μ¤λ” μλ°”μ™€ μ•„μ£Ό λΉ„μ·ν•λ‹¤. μ λ„¤λ¦­ ν•¨μμ™€ ν΄λμ¤λ¥Ό μλ°”μ™€ λΉ„μ·ν•κ² μ„ μ–Έν•  μ μλ‹¤.
- μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ” μ»΄νμΌ μ‹μ μ—λ§ μ΅΄μ¬ν•λ‹¤.
- νƒ€μ… μΈμκ°€ μ‹¤ν–‰ μ‹μ μ— μ§€μ›μ§€λ―€λ΅ νƒ€μ… μΈμκ°€ μλ” νƒ€μ…(μ λ„¤λ¦­ νƒ€μ…)μ„ is μ—°μ‚°μλ¥Ό μ‚¬μ©ν•΄ κ²€μ‚¬ν•  μ μ—†λ‹¤.
- μΈλΌμΈ ν•¨μμ νƒ€μ… λ§¤κ°λ³€μλ¥Ό refiedλ΅ ν‘μ‹ν•΄μ„ μ‹¤μ²΄ν™”ν•λ©΄ 
  μ‹¤ν–‰ μ‹μ μ— κ·Έ νƒ€μ…μ„ isλ΅ κ²€μ‚¬ν•κ±°λ‚ java.lang.Class μΈμ¤ν„΄μ¤λ¥Ό μ–»μ„ μ μλ‹¤.
- λ³€μ„±μ€ κΈ°μ € ν΄λμ¤κ°€ κ°™κ³  νƒ€μ… νλΌλ―Έν„°κ°€ λ‹¤λ¥Έ λ‘ μ λ„¤λ¦­ νƒ€μ… μ‚¬μ΄μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„κ°€ 
  νƒ€μ… μΈμ μ‚¬μ΄μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„μ— μν•΄ μ–΄λ–¤ μν–¥μ„ λ°›λ”μ§€λ¥Ό λ…μ‹ν•λ” λ°©λ²•μ΄λ‹¤.
- μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°κ°€ μ•„μ›ƒ μ„μΉμ—μ„λ§ μ‚¬μ©λλ” κ²½μ°(μƒμ‚°μ) 
  κ·Έ νƒ€μ… νλΌλ―Έν„°λ¥Ό outμΌλ΅ ν‘μ‹ν•΄μ„ κ³µλ³€μ μΌλ΅ λ§λ“¤ μ μλ‹¤.
- κ³µλ³€μ μΈ κ²½μ°μ™€ λ°λ€λ΅ μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°κ°€ μΈ μ„μΉμ—μ„λ§ μ‚¬μ©λλ” κ²½μ°(μ†λΉ„μ) 
  κ·Έ νƒ€μ… νλΌλ―Έν„°λ¥Ό inμΌλ΅ ν‘μ‹ν•΄μ„ λ°κ³µλ³€μ μΌλ΅ λ§λ“¤ μ μλ‹¤.
- μ½”ν‹€λ¦°μ μ½κΈ° μ „μ© List μΈν„°νμ΄μ¤λ” κ³µλ³€μ μ΄λ‹¤. 
  λ”°λΌμ„ `List<String>`μ€ `List<Any>`μ ν•μ„ νƒ€μ…μ΄λ‹¤..
- ν•¨μ μΈν„°νμ΄μ¤λ” μ²« λ²μ§Έ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” λ°κ³µλ³€μ μ΄κ³ , 
  λ‘ λ²μ§Έ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” κ³µλ³€μ μ΄λ‹¤. 
  κ·Έλμ„ (Animal) β†’ Intλ” (Cat) β†’ Numberμ ν•μ„ νƒ€μ…μ΄λ‹¤.
- μ½”ν‹€λ¦°μ—μ„λ” μ λ„¤λ¦­ ν΄λμ¤μ κ³µλ³€μ„±μ„ μ „μ²΄μ μΌλ΅ μ§€μ •ν•κ±°λ‚(μ„ μ–Έ μ§€μ  λ³€μ„±) 
  κµ¬μ²΄μ μΈ μ‚¬μ© μ„μΉμ—μ„ μ§€μ •ν•  μ μλ‹¤. (μ‚¬μ© μ§€μ  λ³€μ„±)
- μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… μΈμκ°€ μ–΄λ–¤ νƒ€μ…μΈμ§€ μ •λ³΄κ°€ μ—†κ±°λ‚ 
  νƒ€μ… μΈμκ°€ μ–΄λ–¤ νƒ€μ…μΈμ§€κ°€ μ¤‘μ”ν•μ§€ μ•μ„ λ• μ¤νƒ€ ν”„λ΅μ μ… κµ¬λ¬Έμ„ μ‚¬μ©ν•  μ μλ‹¤.


<br/>
<br/>
<br/>
<br/>
